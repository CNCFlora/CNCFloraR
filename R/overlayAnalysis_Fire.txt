# Load packages ####

library(sf)
library(rvest)
library(raster)
library(rgeos)
library(stringr)
library(tidyr)
library(rlist)
library(units)
library(spdplyr)
library(exactextractr)
library(magicfor)
library(plyr)
library(dplyr)

# Functions `customCeiling` and `customFloor` ####

customCeiling <- function(x, Decimals=1) {
  x2<-x*10^Decimals
  ceiling(x2)/10^Decimals
}

customFloor <- function(x, Decimals=1) {
  x2<-x*10^Decimals
  floor(x2)/10^Decimals
}

# Importar raster MapBiomas Fogo 1.0 - Brasil, 20m
MapBiomas_Fogo_Brazil <- raster("D:/MapBiomas_Fogo_1.0_20m/mapbiomas_fogo-brazil-collection-10-2020_20m.tif")

# Importar raster MapBiomas Land Use 6.0 - Brasil, 30m
MapBiomas_LandUse_Brazil <- raster("D:/MapBiomas_Brazil_6.0_30m/MapBiomas_Brazil_6.0_2020_30m.tif")

# Species ####

ESPECIE <- "ESPECIEselect"


# Initial background log ####

if(
  
  file.exists(
    
    paste0(
      
      sub("Packages/CNCFloraR", "", getwd()),
      "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
      ESPECIE,
      ".csv"
      
    )
    
  ) == F
  
){
  
  backgroundJobs_log <- data.frame(
    
    job = "Overlay analysis - Fire",
    species = ESPECIE,
    start = format(Sys.Date(), "%d/%m/%Y"),
    end = ""
    
  )
  
  write.csv2(
    
    data.frame(
      
      job = "Overlay analysis - Fire",
      species = ESPECIE,
      start = format(Sys.Date(), "%d/%m/%Y"),
      end = ""
      
    ),
    paste0(
      
      sub("Packages/CNCFloraR", "", getwd()),
      "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
      ESPECIE,
      ".csv"
      
    ),
    row.names = F
    
  )
  
} else {
  
  backgroundJobs_log <- data.table::fread(
    
    paste0(
      
      sub("Packages/CNCFloraR", "", getwd()),
      "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
      ESPECIE,
      ".csv"
      
    )
    
  )
  
}

tryCatch(
  
  expr = {
    
    REGISTROS <- paste0(
      
      sub("Packages/CNCFloraR", "", getwd()),
      "/CNCFlora_data/inputs/occurrences/oldSystem/",
      ESPECIE,
      ".html"
      
    )
    
    input<-read_html(REGISTROS)
    
    # Obtenção do status de validação dos registros ####
    registros<-input %>% html_nodes(".label-valid") %>% html_text()
    registros<-str_extract(registros, "\\w+")
    
    # Obtenção do status de validação SIG ####
    validation_SIG<-input %>% html_nodes(".label-sig") %>% html_text()
    validation_SIG<-str_extract(validation_SIG, "\\w+\\s\\w+")
    
    # Obtenção dos códigos URN ####
    URNs<-input %>% html_nodes("a") %>% html_attr("name")
    URNs<-as.data.frame(URNs)
    URNs<-URNs %>% drop_na()
    URNs<-as.data.frame(URNs[-1,])
    toDelete <- seq(2, nrow(URNs), 2)
    URNs<-as.data.frame(URNs[toDelete,])
    
    # Obtenção dos Estados ####
    ESTADOS<-input %>% html_nodes("#stateProvince") %>% html_attr("value")
    ESTADOS<-toupper(ESTADOS)
    ESTADOS <- sub("AMAPA", "AMAPÁ",ESTADOS)
    ESTADOS <- sub("CEARA", "CEARÁ",ESTADOS)
    ESTADOS <- sub("ESPIRITO SANTO", "ESPÍRITO SANTO",ESTADOS)
    ESTADOS <- sub("GOIAS", "GOIÁS",ESTADOS)
    ESTADOS <- sub("MARANHAO", "MARANHÃO",ESTADOS)
    ESTADOS <- sub("PARAIBA", "PARAÍBA",ESTADOS)
    ESTADOS <- sub("PARANA", "PARANÁ",ESTADOS)
    ESTADOS <- sub("PARA", "PARÁ",ESTADOS)
    ESTADOS <- sub("PARÁNÁ", "PARANÁ",ESTADOS)
    ESTADOS <- sub("PIAUI", "PIAUÍ",ESTADOS)
    ESTADOS <- sub("RONDONIA", "RONDÔNIA",ESTADOS)
    ESTADOS <- sub("SAO PAULO", "SÃO PAULO",ESTADOS)
    ESTADOS <- str_trim(ESTADOS, side = c("both"))
    
    # Obtenção dos municípios ####
    MUNICIPIOS<-input %>% html_nodes("#municipality") %>% html_attr("value")
    MUNICIPIOS <- str_trim(MUNICIPIOS, side = c("both"))
    MUNICIPIOS <- toupper(MUNICIPIOS)
    
    # Obtenção das coordenadas geográficas ####
    # Adicionar na linha 84 do script do HTML
    coords<-input %>% html_elements(".col-md-6") %>% html_elements("input") %>% html_attr("value")
    coords2 <- matrix(coords, ncol = 6, byrow = TRUE)
    coords_df <- as.data.frame(coords2)
    coords_df<-coords_df[,-6]
    coords_df<-coords_df[,-5]
    coords_df<-coords_df %>% dplyr::select(V2, V1, V3, V4)
    coords_df<-data.frame(coords_df,URNs,registros,validation_SIG,ESTADOS,MUNICIPIOS)
    colnames(coords_df) <- c("lon","lat","precision","protocol","URNs","Validade","Validade_SIG","ESTADOS","MUNICIPIOS")
    
    # Triagem dos registros válidos ####
    coords_df_valid <- coords_df %>% filter(Validade=="Válido" & Validade_SIG=="SIG OK")
    
    # Verificação do grau da coordenada ####
    coords_df_valid$Degree_zone <- sub("\\..*", "", coords_df_valid$lon)
    coords_df_valid$Degree_zone <- sub("^$", "EMPTY", coords_df_valid$Degree_zone)
    
    coords_df_valid$UTMzone <- grepl("-",coords_df_valid$lat)
    coords_df_valid$UTMzone <- sub(TRUE, "S", coords_df_valid$UTMzone)
    coords_df_valid$UTMzone <- sub(FALSE, "N", coords_df_valid$UTMzone)
    
    coords_df_valid$Degree_zone <- sub("-", "", coords_df_valid$Degree_zone)
    
    EMPTY_row<-grep("EMPTY", coords_df_valid$Degree_zone)
    
    coords_df_valid$UTMzone[EMPTY_row]<-""
    coords_df_valid$Degree_zone[EMPTY_row]<-""
    
    
    if(dplyr::count(coords_df_valid) == 0){
      
      final_output <-
        data.frame(
          
          Species = ESPECIE,
          Classe = c(
            
            "Soja",
            "Cana-de-açúcar",
            "Lavouras perenes",
            "Outras lavouras temporárias",
            "Pastagem",
            "Mosaico de Agricultura e Pastagem",
            "Infraestrutura urbana",
            "Mineração",
            "Floresta Plantada",
            "Floresta",
            "Savana",
            "Mangue",
            "Campo Alagado e Área Pantanosa",
            "Formação Campestre",
            "Outras Formações não Florestais",
            "Lavoura Temporária",
            "Praia, Duna e Areal",
            "Outras Áreas não Vegetadas",
            "Não Observado",
            "Afloramento Rochoso",
            "Aquicultura",
            "Apicum",
            "Rio, Lago e Oceano",
            "Arroz",
            "Café",
            "Citrus",
            "Outras Lavouras Perenes",
            "Restinga Arborizada"
            
          ),
          Area_AOO_km2 = 0,
          AOO_util_km2 = 0,
          Area_EOO_km2 = 0,
          Fonte = "MapBiomas"
          
        )
      
      write.csv(
        
        final_output,
        paste0(
          
          sub("Packages/CNCFloraR", "", getwd()),
          "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire results/",
          ESPECIE,
          ".csv"
          
        ),
        row.names = F
        
      )
      
      # Finish background log ####
      
      backgroundJobs_log$end <-
        format(Sys.Date(), "%d/%m/%Y")
      
      write.csv2(
        
        backgroundJobs_log,
        paste0(
          
          sub("Packages/CNCFloraR", "", getwd()),
          "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
          ESPECIE,
          ".csv"
          
        ),
        row.names = F
        
      )
      
    } else {
      
      # Verificação da Zona UTM ####
      coords_df_valid_n_row <- as.numeric(1:(length(coords_df_valid$Degree_zone)))
      
      
      for(i in coords_df_valid_n_row){
        coords_df_valid$UTMzone[i]<-paste(ceiling((-as.numeric(coords_df_valid$Degree_zone[i])+180)/6),coords_df_valid$UTMzone[i], sep = "")
      }
      coords_df_valid$UTMzone<-sub("NA","",coords_df_valid$UTMzone)
      
      # Apagamento das coordenadas vazias ####
      coords_df_valid <- coords_df_valid %>% mutate_all(na_if,"")
      for(i in coords_df_valid_n_row){
        if(is.na(coords_df_valid$precision[i])){
          coords_df_valid <- coords_df_valid[-i,]}
      }
      
      # Estipulação do Sistema de Coordenadas Geograficas Projetado para UTM/WGS84 ####
      coords_df_valid$CRS <- coords_df_valid$UTMzone
      coords_df_valid$CRS <- sub("18S", "+proj=utm +zone=18 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("19S", "+proj=utm +zone=19 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("20S", "+proj=utm +zone=20 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("21S", "+proj=utm +zone=21 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("22S", "+proj=utm +zone=22 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("23S", "+proj=utm +zone=23 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("24S", "+proj=utm +zone=24 +south +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("25S", "+proj=utm +zone=25 +south +datum=WGS84", coords_df_valid$CRS)
      
      coords_df_valid$CRS <- sub("18N", "+proj=utm +zone=18 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("19N", "+proj=utm +zone=19 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("20N", "+proj=utm +zone=20 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("21N", "+proj=utm +zone=21 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("22N", "+proj=utm +zone=22 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("23N", "+proj=utm +zone=23 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("24N", "+proj=utm +zone=24 +north +datum=WGS84", coords_df_valid$CRS)
      coords_df_valid$CRS <- sub("25N", "+proj=utm +zone=25 +north +datum=WGS84", coords_df_valid$CRS)
      
      # Apagamento das coordenadas com precisão de centroide de município ####
      coords_df_valid_AOO <- coords_df_valid %>% filter (!str_detect(precision, "[C|c]entr[o|ó]ide"))
      
      # Criação do dataframe das coordenadas geográficas (AOO) ####
      coords_df_valid_AOO[,1] <- as.numeric(coords_df_valid_AOO[,1])
      coords_df_valid_AOO[,2] <- as.numeric(coords_df_valid_AOO[,2])
      if(dplyr::count(coords_df_valid_AOO)==0){sites_AOO<-NA} else{
        sites_AOO <- SpatialPointsDataFrame(coords_df_valid_AOO[,1:2], coords_df_valid_AOO[,3:11])
      }
      
      # Criação do dataframe das coordenadas geográficas (EOO) ####
      coords_df_valid[,1] <- as.numeric(coords_df_valid[,1])
      coords_df_valid[,2] <- as.numeric(coords_df_valid[,2])
      if(dplyr::count(coords_df_valid)==0){sites<-NA} else{
        sites <- SpatialPointsDataFrame(coords_df_valid[,1:2], coords_df_valid[,3:11])
      }
      
      # Diferença de área AOO com/sem centroide de municípios
      sites_as_sf<-st_as_sf(sites)
      if(as.numeric(nrow(unique(sites@coords)))==1){
        sites_grid<-gBuffer(as_Spatial(sites_as_sf), byid = TRUE, capStyle = "SQUARE", width = 0.01)
        sites_grid_AOO<-st_as_sf(sites_grid)
        rm(sites_grid)
      } else{
        sites_grid<-st_make_grid(sites_as_sf, cellsize = .02)
        sites_grid_AOO<-sites_grid[sites_as_sf]
        rm(sites_grid)
      }
      AOO_area_c_centr_mun<-round(sum(st_area(sites_grid_AOO)*10000))
      
      if(is.na(sites_AOO)==T){
        AOO_area_s_centr_mun<-0
      } else{
        sites_AOO_as_sf<-st_as_sf(sites_AOO)
        if(as.numeric(nrow(unique(sites_AOO@coords)))==1){
          sites_AOO_grid<-gBuffer(as_Spatial(sites_AOO_as_sf), byid = TRUE, capStyle = "SQUARE", width = 0.01)
          sites_AOO_grid_AOO<-st_as_sf(sites_AOO_grid)
        } else{
          sites_AOO_grid<-st_make_grid(sites_AOO_as_sf, cellsize = .02)
          sites_AOO_grid_AOO<-sites_AOO_grid[sites_AOO_as_sf]
        }
        AOO_area_s_centr_mun<-round(sum(st_area(sites_AOO_grid_AOO)*10000))
      }
      
      # EOO ####
      if(is.na(sites)==T|nrow(unique(data.frame(lat=coords_df_valid$lat, lon=coords_df_valid$lon))) < 3){
        EOO <- 0
        area_EOO_km2 <- 0
      } else {
        EOO <- gConvexHull(sites)
        
        ## UTM zones to calculte EOO
        EOO_18N<-crop(EOO, extent(-78, -72, 0, 90))
        if(is.null(EOO_18N)==T){} else{
          crs(EOO_18N)<-"+proj=utm +zone=18 +north +datum=WGS84"
          area_EOO_18N <- raster::area(EOO_18N)
          area_km2_EOO_18N <- set_units(area_EOO_18N * 10000, km^2)
        }
        EOO_18S<-crop(EOO, extent(-78, -72, -90, 0))
        if(is.null(EOO_18S)==T){} else{
          crs(EOO_18S)<-"+proj=utm +zone=18 +south +datum=WGS84"
          area_EOO_18S <- raster::area(EOO_18S)
          area_km2_EOO_18S <- set_units(area_EOO_18S * 10000, km^2)
        }
        EOO_19N<-crop(EOO, extent(-72, -66, 0, 90))
        if(is.null(EOO_19N)==T){} else{
          crs(EOO_19N)<-"+proj=utm +zone=19 +north +datum=WGS84"
          area_EOO_19N <- raster::area(EOO_19N)
          area_km2_EOO_19N <- set_units(area_EOO_19N * 10000, km^2)
        }
        EOO_19S<-crop(EOO, extent(-72, -66, -90, 0))
        if(is.null(EOO_19S)==T){} else{
          crs(EOO_19S)<-"+proj=utm +zone=19 +south +datum=WGS84"
          area_EOO_19S <- raster::area(EOO_19S)
          area_km2_EOO_19S <- set_units(area_EOO_19S * 10000, km^2)
        }
        EOO_20N<-crop(EOO, extent(-66, -60, 0, 90))
        if(is.null(EOO_20N)==T){} else{
          crs(EOO_20N)<-"+proj=utm +zone=20 +north +datum=WGS84"
          area_EOO_20N <- raster::area(EOO_20N)
          area_km2_EOO_20N <- set_units(area_EOO_20N * 10000, km^2)
        }
        EOO_20S<-crop(EOO, extent(-66, -60, -90, 0))
        if(is.null(EOO_20S)==T){} else{
          crs(EOO_20S)<-"+proj=utm +zone=20 +south +datum=WGS84"
          area_EOO_20S <- raster::area(EOO_20S)
          area_km2_EOO_20S <- set_units(area_EOO_20S * 10000, km^2)
        }
        EOO_21N<-crop(EOO, extent(-60, -54, 0, 90))
        if(is.null(EOO_21N)==T){} else{
          crs(EOO_21N)<-"+proj=utm +zone=21 +north +datum=WGS84"
          area_EOO_21N <- raster::area(EOO_21N)
          area_km2_EOO_21N <- set_units(area_EOO_21N * 10000, km^2)
        }
        EOO_21S<-crop(EOO, extent(-60, -54, -90, 0))
        if(is.null(EOO_21S)==T){} else{
          crs(EOO_21S)<-"+proj=utm +zone=21 +south +datum=WGS84"
          area_EOO_21S <- raster::area(EOO_21S)
          area_km2_EOO_21S <- set_units(area_EOO_21S * 10000, km^2)
        }
        EOO_22N<-crop(EOO, extent(-54, -48, 0, 90))
        if(is.null(EOO_22N)==T){} else{
          crs(EOO_22N)<-"+proj=utm +zone=22 +north +datum=WGS84"
          area_EOO_22N <- raster::area(EOO_22N)
          area_km2_EOO_22N <- set_units(area_EOO_22N * 10000, km^2)
        }
        EOO_22S<-crop(EOO, extent(-54, -48, -90, 0))
        if(is.null(EOO_22S)==T){} else{
          crs(EOO_22S)<-"+proj=utm +zone=22 +south +datum=WGS84"
          area_EOO_22S <- raster::area(EOO_22S)
          area_km2_EOO_22S <- set_units(area_EOO_22S * 10000, km^2)
        }
        EOO_23N<-crop(EOO, extent(-48, -42, 0, 90))
        if(is.null(EOO_23N)==T){} else{
          crs(EOO_23N)<-"+proj=utm +zone=23 +north +datum=WGS84"
          area_EOO_23N <- raster::area(EOO_23N)
          area_km2_EOO_23N <- set_units(area_EOO_23N * 10000, km^2)
        }
        EOO_23S<-crop(EOO, extent(-48, -42, -90, 90))
        if(is.null(EOO_23S)==T){} else{
          crs(EOO_23S)<-"+proj=utm +zone=23 +south +datum=WGS84"
          area_EOO_23S <- raster::area(EOO_23S)
          area_km2_EOO_23S <- set_units(area_EOO_23S * 10000, km^2)
        }
        EOO_24N<-crop(EOO, extent(-42, -36, 0, 90))
        if(is.null(EOO_24N)==T){} else{
          crs(EOO_24N)<-"+proj=utm +zone=24 +north +datum=WGS84"
          area_EOO_24N <- raster::area(EOO_24N)
          area_km2_EOO_24N <- set_units(area_EOO_24N * 10000, km^2)
        }
        EOO_24S<-crop(EOO, extent(-42, -36, -90, 0))
        if(is.null(EOO_24S)==T){} else{
          crs(EOO_24S)<-"+proj=utm +zone=24 +south +datum=WGS84"
          area_EOO_24S <- raster::area(EOO_24S)
          area_km2_EOO_24S <- set_units(area_EOO_24S * 10000, km^2)
        }
        EOO_25N<-crop(EOO, extent(-36, -30, 0, 90))
        if(is.null(EOO_25N)==T){} else{
          crs(EOO_25N)<-"+proj=utm +zone=25 +north +datum=WGS84"
          area_EOO_25N <- raster::area(EOO_25N)
          area_km2_EOO_25N <- set_units(area_EOO_25N * 10000, km^2)
        }
        EOO_25S<-crop(EOO, extent(-36, -30, -90, 0))
        if(is.null(EOO_25S)==T){} else{
          crs(EOO_25S)<-"+proj=utm +zone=25 +south +datum=WGS84"
          area_EOO_25S <- raster::area(EOO_25S)
          area_km2_EOO_25S <- set_units(area_EOO_25S * 10000, km^2)
        }
        
        # Merge areas of UTM zones
        area_EOO_km2 <- sum(
          if(exists("area_km2_EOO_18N")){area_km2_EOO_18N},
          if(exists("area_km2_EOO_18S")){area_km2_EOO_18S},
          if(exists("area_km2_EOO_19N")){area_km2_EOO_19N},
          if(exists("area_km2_EOO_19S")){area_km2_EOO_19S},
          if(exists("area_km2_EOO_20N")){area_km2_EOO_20N},
          if(exists("area_km2_EOO_20S")){area_km2_EOO_20S},
          if(exists("area_km2_EOO_21N")){area_km2_EOO_21N},
          if(exists("area_km2_EOO_21S")){area_km2_EOO_21S},
          if(exists("area_km2_EOO_22N")){area_km2_EOO_22N},
          if(exists("area_km2_EOO_22S")){area_km2_EOO_22S},
          if(exists("area_km2_EOO_23N")){area_km2_EOO_23N},
          if(exists("area_km2_EOO_23S")){area_km2_EOO_23S},
          if(exists("area_km2_EOO_24N")){area_km2_EOO_24N},
          if(exists("area_km2_EOO_24S")){area_km2_EOO_24S},
          if(exists("area_km2_EOO_25N")){area_km2_EOO_25N},
          if(exists("area_km2_EOO_25S")){area_km2_EOO_25S}
        )
        
        ## Sobreposição EOO ####
        if(as.numeric(area_EOO_km2) <= 40000){
          
          if(exists("area_km2_EOO_18N")){
            MapBiomas_Fogo_Brazil_EOO_18N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_18N) <- "+proj=utm +zone=18 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_18N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_18N) <- "+proj=utm +zone=18 +north +datum=WGS84"
            EOO_18N_sf <- st_as_sf(EOO_18N)
            
            MapBiomas_Fogo_Brazil_EOO_18N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_18N, extent(EOO_18N))
            MapBiomas_Fogo_Brazil_EOO_18N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_18N, EOO_18N)
            MapBiomas_Fogo_Brazil_EOO_18N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_18N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_18N <- bbox(EOO_18N)
            bbox_18N_ymin <- bbox_18N[2,1]
            bbox_18N_ymax <- bbox_18N[2,2]
            
            seq_y <- seq(customFloor(bbox_18N_ymin), customCeiling(bbox_18N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_18N","_", i, sep = ""), crop(EOO_18N, extent(-78, -72, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_18N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_18N","_", i, sep = ""))))
              assign(paste("analise_EOO_18N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_18N, MapBiomas_Fogo_Brazil_EOO_18N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_18N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_18N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_18N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_18N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_18N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_18N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_18N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_18N","_", i, sep = "")))
              area_slices_EOO_18N <- sum(area_slices_EOO_18N, area_slice)
            }
            
            area_slices_EOO_18N <- set_units(area_slices_EOO_18N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_18N, 4)==round(area_km2_EOO_18N, 4)
            
            analise_EOO_18N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_18N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_18N_summ <- rbind(analise_EOO_18N_summ, merge_data)
            }
            analiseEOO_18N <- analise_EOO_18N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_18S")){
            MapBiomas_Fogo_Brazil_EOO_18S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_18S) <- "+proj=utm +zone=18 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_18S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_18S) <- "+proj=utm +zone=18 +south +datum=WGS84"
            EOO_18S_sf <- st_as_sf(EOO_18S)
            
            MapBiomas_Fogo_Brazil_EOO_18S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_18S, extent(EOO_18S))
            MapBiomas_Fogo_Brazil_EOO_18S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_18S, EOO_18S)
            MapBiomas_Fogo_Brazil_EOO_18S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_18S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_18S <- bbox(EOO_18S)
            bbox_18S_ymin <- bbox_18S[2,1]
            bbox_18S_ymax <- bbox_18S[2,2]
            
            seq_y <- seq(customFloor(bbox_18S_ymin), customCeiling(bbox_18S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_18S","_", i, sep = ""), crop(EOO_18S, extent(-78, -72, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_18S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_18S","_", i, sep = ""))))
              assign(paste("analise_EOO_18S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_18S, MapBiomas_Fogo_Brazil_EOO_18S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_18S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_18S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_18S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_18S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_18S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_18S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_18S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_18S","_", i, sep = "")))
              area_slices_EOO_18S <- sum(area_slices_EOO_18S, area_slice)
            }
            
            area_slices_EOO_18S <- set_units(area_slices_EOO_18S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_18S, 4)==round(area_km2_EOO_18S, 4)
            
            analise_EOO_18S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_18S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_18S_summ <- rbind(analise_EOO_18S_summ, merge_data)
            }
            analiseEOO_18S <- analise_EOO_18S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_19N")){
            MapBiomas_Fogo_Brazil_EOO_19N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_19N) <- "+proj=utm +zone=19 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_19N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_19N) <- "+proj=utm +zone=19 +north +datum=WGS84"
            EOO_19N_sf <- st_as_sf(EOO_19N)
            
            MapBiomas_Fogo_Brazil_EOO_19N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_19N, extent(EOO_19N))
            MapBiomas_Fogo_Brazil_EOO_19N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_19N, EOO_19N)
            MapBiomas_Fogo_Brazil_EOO_19N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_19N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_19N <- bbox(EOO_19N)
            bbox_19N_ymin <- bbox_19N[2,1]
            bbox_19N_ymax <- bbox_19N[2,2]
            
            seq_y <- seq(customFloor(bbox_19N_ymin), customCeiling(bbox_19N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_19N","_", i, sep = ""), crop(EOO_19N, extent(-72, -66, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_19N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_19N","_", i, sep = ""))))
              assign(paste("analise_EOO_19N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_19N, MapBiomas_Fogo_Brazil_EOO_19N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_19N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_19N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_19N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_19N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_19N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_19N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_19N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_19N","_", i, sep = "")))
              area_slices_EOO_19N <- sum(area_slices_EOO_19N, area_slice)
            }
            
            area_slices_EOO_19N <- set_units(area_slices_EOO_19N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_19N, 4)==round(area_km2_EOO_19N, 4)
            
            analise_EOO_19N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_19N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_19N_summ <- rbind(analise_EOO_19N_summ, merge_data)
            }
            analiseEOO_19N <- analise_EOO_19N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_19S")){
            MapBiomas_Fogo_Brazil_EOO_19S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_19S) <- "+proj=utm +zone=19 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_19S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_19S) <- "+proj=utm +zone=19 +south +datum=WGS84"
            EOO_19S_sf <- st_as_sf(EOO_19S)
            
            MapBiomas_Fogo_Brazil_EOO_19S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_19S, extent(EOO_19S))
            MapBiomas_Fogo_Brazil_EOO_19S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_19S, EOO_19S)
            MapBiomas_Fogo_Brazil_EOO_19S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_19S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_19S <- bbox(EOO_19S)
            bbox_19S_ymin <- bbox_19S[2,1]
            bbox_19S_ymax <- bbox_19S[2,2]
            
            seq_y <- seq(customFloor(bbox_19S_ymin), customCeiling(bbox_19S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_19S","_", i, sep = ""), crop(EOO_19S, extent(-72, -66, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_19S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_19S","_", i, sep = ""))))
              assign(paste("analise_EOO_19S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_19S, MapBiomas_Fogo_Brazil_EOO_19S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_19S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_19S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_19S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_19S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_19S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_19S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_19S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_19S","_", i, sep = "")))
              area_slices_EOO_19S <- sum(area_slices_EOO_19S, area_slice)
            }
            
            area_slices_EOO_19S <- set_units(area_slices_EOO_19S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_19S, 4)==round(area_km2_EOO_19S, 4)
            
            analise_EOO_19S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_19S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_19S_summ <- rbind(analise_EOO_19S_summ, merge_data)
            }
            analiseEOO_19S <- analise_EOO_19S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_20N")){
            MapBiomas_Fogo_Brazil_EOO_20N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_20N) <- "+proj=utm +zone=20 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_20N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_20N) <- "+proj=utm +zone=20 +north +datum=WGS84"
            EOO_20N_sf <- st_as_sf(EOO_20N)
            
            MapBiomas_Fogo_Brazil_EOO_20N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_20N, extent(EOO_20N))
            MapBiomas_Fogo_Brazil_EOO_20N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_20N, EOO_20N)
            MapBiomas_Fogo_Brazil_EOO_20N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_20N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_20N <- bbox(EOO_20N)
            bbox_20N_ymin <- bbox_20N[2,1]
            bbox_20N_ymax <- bbox_20N[2,2]
            
            seq_y <- seq(customFloor(bbox_20N_ymin), customCeiling(bbox_20N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_20N","_", i, sep = ""), crop(EOO_20N, extent(-66, -60, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_20N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_20N","_", i, sep = ""))))
              assign(paste("analise_EOO_20N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_20N, MapBiomas_Fogo_Brazil_EOO_20N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_20N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_20N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_20N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_20N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_20N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_20N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_20N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_20N","_", i, sep = "")))
              area_slices_EOO_20N <- sum(area_slices_EOO_20N, area_slice)
            }
            
            area_slices_EOO_20N <- set_units(area_slices_EOO_20N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_20N, 4)==round(area_km2_EOO_20N, 4)
            
            analise_EOO_20N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_20N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_20N_summ <- rbind(analise_EOO_20N_summ, merge_data)
            }
            analiseEOO_20N <- analise_EOO_20N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_20S")){
            MapBiomas_Fogo_Brazil_EOO_20S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_20S) <- "+proj=utm +zone=20 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_20S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_20S) <- "+proj=utm +zone=20 +south +datum=WGS84"
            EOO_20S_sf <- st_as_sf(EOO_20S)
            
            MapBiomas_Fogo_Brazil_EOO_20S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_20S, extent(EOO_20S))
            MapBiomas_Fogo_Brazil_EOO_20S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_20S, EOO_20S)
            MapBiomas_Fogo_Brazil_EOO_20S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_20S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_20S <- bbox(EOO_20S)
            bbox_20S_ymin <- bbox_20S[2,1]
            bbox_20S_ymax <- bbox_20S[2,2]
            
            seq_y <- seq(customFloor(bbox_20S_ymin), customCeiling(bbox_20S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_20S","_", i, sep = ""), crop(EOO_20S, extent(-66, -60, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_20S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_20S","_", i, sep = ""))))
              assign(paste("analise_EOO_20S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_20S, MapBiomas_Fogo_Brazil_EOO_20S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_20S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_20S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_20S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_20S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_20S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_20S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_20S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_20S","_", i, sep = "")))
              area_slices_EOO_20S <- sum(area_slices_EOO_20S, area_slice)
            }
            
            area_slices_EOO_20S <- set_units(area_slices_EOO_20S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_20S, 4)==round(area_km2_EOO_20S, 4)
            
            analise_EOO_20S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_20S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_20S_summ <- rbind(analise_EOO_20S_summ, merge_data)
            }
            analiseEOO_20S <- analise_EOO_20S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_21N")){
            MapBiomas_Fogo_Brazil_EOO_21N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_21N) <- "+proj=utm +zone=21 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_21N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_21N) <- "+proj=utm +zone=21 +north +datum=WGS84"
            EOO_21N_sf <- st_as_sf(EOO_21N)
            
            MapBiomas_Fogo_Brazil_EOO_21N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_21N, extent(EOO_21N))
            MapBiomas_Fogo_Brazil_EOO_21N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_21N, EOO_21N)
            MapBiomas_Fogo_Brazil_EOO_21N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_21N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_21N <- bbox(EOO_21N)
            bbox_21N_ymin <- bbox_21N[2,1]
            bbox_21N_ymax <- bbox_21N[2,2]
            
            seq_y <- seq(customFloor(bbox_21N_ymin), customCeiling(bbox_21N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_21N","_", i, sep = ""), crop(EOO_21N, extent(-60, -54, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_21N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_21N","_", i, sep = ""))))
              assign(paste("analise_EOO_21N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_21N, MapBiomas_Fogo_Brazil_EOO_21N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_21N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_21N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_21N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_21N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_21N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_21N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_21N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_21N","_", i, sep = "")))
              area_slices_EOO_21N <- sum(area_slices_EOO_21N, area_slice)
            }
            
            area_slices_EOO_21N <- set_units(area_slices_EOO_21N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_21N, 4)==round(area_km2_EOO_21N, 4)
            
            analise_EOO_21N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_21N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_21N_summ <- rbind(analise_EOO_21N_summ, merge_data)
            }
            analiseEOO_21N <- analise_EOO_21N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_21S")){
            MapBiomas_Fogo_Brazil_EOO_21S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_21S) <- "+proj=utm +zone=21 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_21S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_21S) <- "+proj=utm +zone=21 +south +datum=WGS84"
            EOO_21S_sf <- st_as_sf(EOO_21S)
            
            MapBiomas_Fogo_Brazil_EOO_21S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_21S, extent(EOO_21S))
            MapBiomas_Fogo_Brazil_EOO_21S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_21S, EOO_21S)
            MapBiomas_Fogo_Brazil_EOO_21S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_21S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_21S <- bbox(EOO_21S)
            bbox_21S_ymin <- bbox_21S[2,1]
            bbox_21S_ymax <- bbox_21S[2,2]
            
            seq_y <- seq(customFloor(bbox_21S_ymin), customCeiling(bbox_21S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_21S","_", i, sep = ""), crop(EOO_21S, extent(-60, -54, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_21S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_21S","_", i, sep = ""))))
              assign(paste("analise_EOO_21S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_21S, MapBiomas_Fogo_Brazil_EOO_21S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_21S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_21S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_21S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_21S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_21S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_21S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_21S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_21S","_", i, sep = "")))
              area_slices_EOO_21S <- sum(area_slices_EOO_21S, area_slice)
            }
            
            area_slices_EOO_21S <- set_units(area_slices_EOO_21S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_21S, 4)==round(area_km2_EOO_21S, 4)
            
            analise_EOO_21S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_21S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_21S_summ <- rbind(analise_EOO_21S_summ, merge_data)
            }
            analiseEOO_21S <- analise_EOO_21S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_22N")){
            MapBiomas_Fogo_Brazil_EOO_22N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_22N) <- "+proj=utm +zone=22 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_22N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_22N) <- "+proj=utm +zone=22 +north +datum=WGS84"
            EOO_22N_sf <- st_as_sf(EOO_22N)
            
            MapBiomas_Fogo_Brazil_EOO_22N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_22N, extent(EOO_22N))
            MapBiomas_Fogo_Brazil_EOO_22N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_22N, EOO_22N)
            MapBiomas_Fogo_Brazil_EOO_22N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_22N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_22N <- bbox(EOO_22N)
            bbox_22N_ymin <- bbox_22N[2,1]
            bbox_22N_ymax <- bbox_22N[2,2]
            
            seq_y <- seq(customFloor(bbox_22N_ymin), customCeiling(bbox_22N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_22N","_", i, sep = ""), crop(EOO_22N, extent(-54, -48, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_22N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_22N","_", i, sep = ""))))
              assign(paste("analise_EOO_22N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_22N, MapBiomas_Fogo_Brazil_EOO_22N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_22N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_22N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_22N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_22N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_22N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_22N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_22N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_22N","_", i, sep = "")))
              area_slices_EOO_22N <- sum(area_slices_EOO_22N, area_slice)
            }
            
            area_slices_EOO_22N <- set_units(area_slices_EOO_22N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_22N, 4)==round(area_km2_EOO_22N, 4)
            
            analise_EOO_22N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_22N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_22N_summ <- rbind(analise_EOO_22N_summ, merge_data)
            }
            analiseEOO_22N <- analise_EOO_22N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_22S")){
            MapBiomas_Fogo_Brazil_EOO_22S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_22S) <- "+proj=utm +zone=22 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_22S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_22S) <- "+proj=utm +zone=22 +south +datum=WGS84"
            EOO_22S_sf <- st_as_sf(EOO_22S)
            
            MapBiomas_Fogo_Brazil_EOO_22S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_22S, extent(EOO_22S))
            MapBiomas_Fogo_Brazil_EOO_22S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_22S, EOO_22S)
            MapBiomas_Fogo_Brazil_EOO_22S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_22S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_22S <- bbox(EOO_22S)
            bbox_22S_ymin <- bbox_22S[2,1]
            bbox_22S_ymax <- bbox_22S[2,2]
            
            seq_y <- seq(customFloor(bbox_22S_ymin), customCeiling(bbox_22S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_22S","_", i, sep = ""), crop(EOO_22S, extent(-54, -48, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_22S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_22S","_", i, sep = ""))))
              assign(paste("analise_EOO_22S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_22S, MapBiomas_Fogo_Brazil_EOO_22S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_22S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_22S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_22S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_22S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_22S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_22S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_22S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_22S","_", i, sep = "")))
              area_slices_EOO_22S <- sum(area_slices_EOO_22S, area_slice)
            }
            
            area_slices_EOO_22S <- set_units(area_slices_EOO_22S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_22S, 4)==round(area_km2_EOO_22S, 4)
            
            analise_EOO_22S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_22S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_22S_summ <- rbind(analise_EOO_22S_summ, merge_data)
            }
            analiseEOO_22S <- analise_EOO_22S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_23N")){
            MapBiomas_Fogo_Brazil_EOO_23N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_23N) <- "+proj=utm +zone=23 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_23N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_23N) <- "+proj=utm +zone=23 +north +datum=WGS84"
            EOO_23N_sf <- st_as_sf(EOO_23N)
            
            MapBiomas_Fogo_Brazil_EOO_23N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_23N, extent(EOO_23N))
            MapBiomas_Fogo_Brazil_EOO_23N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_23N, EOO_23N)
            MapBiomas_Fogo_Brazil_EOO_23N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_23N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_23N <- bbox(EOO_23N)
            bbox_23N_ymin <- bbox_23N[2,1]
            bbox_23N_ymax <- bbox_23N[2,2]
            
            seq_y <- seq(customFloor(bbox_23N_ymin), customCeiling(bbox_23N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_23N","_", i, sep = ""), crop(EOO_23N, extent(-48, -42, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_23N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_23N","_", i, sep = ""))))
              assign(paste("analise_EOO_23N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_23N, MapBiomas_Fogo_Brazil_EOO_23N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_23N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_23N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_23N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_23N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_23N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_23N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_23N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_23N","_", i, sep = "")))
              area_slices_EOO_23N <- sum(area_slices_EOO_23N, area_slice)
            }
            
            area_slices_EOO_23N <- set_units(area_slices_EOO_23N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_23N, 4)==round(area_km2_EOO_23N, 4)
            
            analise_EOO_23N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_23N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_23N_summ <- rbind(analise_EOO_23N_summ, merge_data)
            }
            analiseEOO_23N <- analise_EOO_23N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_23S")){
            MapBiomas_Fogo_Brazil_EOO_23S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_23S) <- "+proj=utm +zone=23 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_23S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_23S) <- "+proj=utm +zone=23 +south +datum=WGS84"
            EOO_23S_sf <- st_as_sf(EOO_23S)
            
            MapBiomas_Fogo_Brazil_EOO_23S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_23S, extent(EOO_23S))
            MapBiomas_Fogo_Brazil_EOO_23S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_23S, EOO_23S)
            MapBiomas_Fogo_Brazil_EOO_23S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_23S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_23S <- bbox(EOO_23S)
            bbox_23S_ymin <- bbox_23S[2,1]
            bbox_23S_ymax <- bbox_23S[2,2]
            
            seq_y <- seq(customFloor(bbox_23S_ymin), customCeiling(bbox_23S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            if(nrow(MapBiomas_Fogo_Brazil_EOO_23S) == 0){
              ############## CONTINUAR AQUI!!!!!!!!!!!!!!!!!
              rm(area_km2_EOO_23S)
              rm(MapBiomas_Fogo_Brazil_EOO_23S)
              rm(MapBiomas_LandUse_BrazilEOO_23S)
              
              analiseEOO_23S <-
                data.frame(
                  
                  mapbiomas_fogo.brazil.collection.10.2020_20m = NA,
                  value = NA,
                  coverage_fraction = NA
                  
                )
              
            } else {
              
              for(i in seq_y_num){
                assign(paste("EOO_23S","_", i, sep = ""), crop(EOO_23S, extent(-48, -42, seq_y[i], seq_y[i+1])))
                assign(paste("EOO_23S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_23S","_", i, sep = ""))))
                assign(paste("analise_EOO_23S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_23S, MapBiomas_Fogo_Brazil_EOO_23S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
                assign(paste("analise_EOO_23S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_23S","_", i, "_sf", sep = ""))))
                assign(paste("analise_EOO_23S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_23S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
                
                rm(list = paste("analise_EOO_23S","_", i, "_sf", sep = ""))
                rm(list = paste("analise_EOO_23S","_", i, "_sf_as_df", sep = ""))
              }
              
              # Para controle
              area_slices_EOO_23S<-NULL
              for(i in seq_y_num){
                area_slice <- area(get(paste("EOO_23S","_", i, sep = "")))
                area_slices_EOO_23S <- sum(area_slices_EOO_23S, area_slice)
              }
              
              area_slices_EOO_23S <- set_units(area_slices_EOO_23S * 10000, km^2)
              
              ## Teste
              round(area_slices_EOO_23S, 4)==round(area_km2_EOO_23S, 4)
              
              analise_EOO_23S_summ <- NULL
              for(i in seq_y_num){
                
                merge_data <- get(paste("analise_EOO_23S","_", i, "_sf_as_df_summ", sep = ""))
                analise_EOO_23S_summ <- rbind(analise_EOO_23S_summ, merge_data)
                
              }
              
              analiseEOO_23S <- analise_EOO_23S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
              
            }
            
          }
          
          if(exists("area_km2_EOO_24N")){
            MapBiomas_Fogo_Brazil_EOO_24N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_24N) <- "+proj=utm +zone=24 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_24N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_24N) <- "+proj=utm +zone=24 +north +datum=WGS84"
            EOO_24N_sf <- st_as_sf(EOO_24N)
            
            MapBiomas_Fogo_Brazil_EOO_24N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_24N, extent(EOO_24N))
            MapBiomas_Fogo_Brazil_EOO_24N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_24N, EOO_24N)
            MapBiomas_Fogo_Brazil_EOO_24N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_24N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_24N <- bbox(EOO_24N)
            bbox_24N_ymin <- bbox_24N[2,1]
            bbox_24N_ymax <- bbox_24N[2,2]
            
            seq_y <- seq(customFloor(bbox_24N_ymin), customCeiling(bbox_24N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_24N","_", i, sep = ""), crop(EOO_24N, extent(-42, -36, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_24N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_24N","_", i, sep = ""))))
              assign(paste("analise_EOO_24N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_24N, MapBiomas_Fogo_Brazil_EOO_24N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_24N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_24N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_24N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_24N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_24N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_24N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_24N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_24N","_", i, sep = "")))
              area_slices_EOO_24N <- sum(area_slices_EOO_24N, area_slice)
            }
            
            area_slices_EOO_24N <- set_units(area_slices_EOO_24N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_24N, 4)==round(area_km2_EOO_24N, 4)
            
            analise_EOO_24N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_24N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_24N_summ <- rbind(analise_EOO_24N_summ, merge_data)
            }
            analiseEOO_24N <- analise_EOO_24N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_24S")){
            MapBiomas_Fogo_Brazil_EOO_24S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_24S) <- "+proj=utm +zone=24 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_24S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_24S) <- "+proj=utm +zone=24 +south +datum=WGS84"
            EOO_24S_sf <- st_as_sf(EOO_24S)
            
            MapBiomas_Fogo_Brazil_EOO_24S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_24S, extent(EOO_24S))
            MapBiomas_Fogo_Brazil_EOO_24S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_24S, EOO_24S)
            MapBiomas_Fogo_Brazil_EOO_24S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_24S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_24S <- bbox(EOO_24S)
            bbox_24S_ymin <- bbox_24S[2,1]
            bbox_24S_ymax <- bbox_24S[2,2]
            
            seq_y <- seq(customFloor(bbox_24S_ymin), customCeiling(bbox_24S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_24S","_", i, sep = ""), crop(EOO_24S, extent(-42, -36, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_24S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_24S","_", i, sep = ""))))
              assign(paste("analise_EOO_24S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_24S, MapBiomas_Fogo_Brazil_EOO_24S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_24S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_24S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_24S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_24S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_24S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_24S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_24S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_24S","_", i, sep = "")))
              area_slices_EOO_24S <- sum(area_slices_EOO_24S, area_slice)
            }
            
            area_slices_EOO_24S <- set_units(area_slices_EOO_24S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_24S, 4)==round(area_km2_EOO_24S, 4)
            
            analise_EOO_24S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_24S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_24S_summ <- rbind(analise_EOO_24S_summ, merge_data)
            }
            analiseEOO_24S <- analise_EOO_24S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_25N")){
            MapBiomas_Fogo_Brazil_EOO_25N <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_25N) <- "+proj=utm +zone=25 +north +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_25N <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_25N) <- "+proj=utm +zone=25 +north +datum=WGS84"
            EOO_25N_sf <- st_as_sf(EOO_25N)
            
            MapBiomas_Fogo_Brazil_EOO_25N <- terra::crop(MapBiomas_Fogo_Brazil_EOO_25N, extent(EOO_25N))
            MapBiomas_Fogo_Brazil_EOO_25N <- terra::mask(MapBiomas_Fogo_Brazil_EOO_25N, EOO_25N)
            MapBiomas_Fogo_Brazil_EOO_25N <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_25N), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_25N <- bbox(EOO_25N)
            bbox_25N_ymin <- bbox_25N[2,1]
            bbox_25N_ymax <- bbox_25N[2,2]
            
            seq_y <- seq(customFloor(bbox_25N_ymin), customCeiling(bbox_25N_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_25N","_", i, sep = ""), crop(EOO_25N, extent(-36, -30, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_25N","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_25N","_", i, sep = ""))))
              assign(paste("analise_EOO_25N","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_25N, MapBiomas_Fogo_Brazil_EOO_25N, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_25N","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_25N","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_25N","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_25N","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_25N","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_25N","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_25N<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_25N","_", i, sep = "")))
              area_slices_EOO_25N <- sum(area_slices_EOO_25N, area_slice)
            }
            
            area_slices_EOO_25N <- set_units(area_slices_EOO_25N * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_25N, 4)==round(area_km2_EOO_25N, 4)
            
            analise_EOO_25N_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_25N","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_25N_summ <- rbind(analise_EOO_25N_summ, merge_data)
            }
            analiseEOO_25N <- analise_EOO_25N_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          if(exists("area_km2_EOO_25S")){
            MapBiomas_Fogo_Brazil_EOO_25S <- MapBiomas_Fogo_Brazil
            crs(MapBiomas_Fogo_Brazil_EOO_25S) <- "+proj=utm +zone=25 +south +datum=WGS84"
            MapBiomas_LandUse_BrazilEOO_25S <- MapBiomas_LandUse_Brazil
            crs(MapBiomas_LandUse_BrazilEOO_25S) <- "+proj=utm +zone=25 +south +datum=WGS84"
            EOO_25S_sf <- st_as_sf(EOO_25S)
            
            MapBiomas_Fogo_Brazil_EOO_25S <- terra::crop(MapBiomas_Fogo_Brazil_EOO_25S, extent(EOO_25S))
            MapBiomas_Fogo_Brazil_EOO_25S <- terra::mask(MapBiomas_Fogo_Brazil_EOO_25S, EOO_25S)
            MapBiomas_Fogo_Brazil_EOO_25S <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil_EOO_25S), point = FALSE, merge = TRUE, connect8 = TRUE)
            
            bbox_25S <- bbox(EOO_25S)
            bbox_25S_ymin <- bbox_25S[2,1]
            bbox_25S_ymax <- bbox_25S[2,2]
            
            seq_y <- seq(customFloor(bbox_25S_ymin), customCeiling(bbox_25S_ymax), by=0.1)
            seq_y_num_total <- length(seq_y)
            seq_y_num <- 1:length(seq_y)
            seq_y_num <- seq_y_num[-seq_y_num_total]
            
            for(i in seq_y_num){
              assign(paste("EOO_25S","_", i, sep = ""), crop(EOO_25S, extent(-36, -30, seq_y[i], seq_y[i+1])))
              assign(paste("EOO_25S","_", i, "_sf", sep = ""), st_as_sf(get(paste("EOO_25S","_", i, sep = ""))))
              assign(paste("analise_EOO_25S","_", i, "_sf", sep = ""), exact_extract(MapBiomas_LandUse_BrazilEOO_25S, MapBiomas_Fogo_Brazil_EOO_25S, include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m", progress = F))
              assign(paste("analise_EOO_25S","_", i, "_sf_as_df", sep = ""), do.call(rbind, get(paste("analise_EOO_25S","_", i, "_sf", sep = ""))))
              assign(paste("analise_EOO_25S","_", i, "_sf_as_df_summ", sep = ""), get(paste("analise_EOO_25S","_", i, "_sf_as_df", sep = "")) %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction = sum(coverage_fraction)))
              
              rm(list = paste("analise_EOO_25S","_", i, "_sf", sep = ""))
              rm(list = paste("analise_EOO_25S","_", i, "_sf_as_df", sep = ""))
            }
            
            # Para controle
            area_slices_EOO_25S<-NULL
            for(i in seq_y_num){
              area_slice <- area(get(paste("EOO_25S","_", i, sep = "")))
              area_slices_EOO_25S <- sum(area_slices_EOO_25S, area_slice)
            }
            
            area_slices_EOO_25S <- set_units(area_slices_EOO_25S * 10000, km^2)
            
            ## Teste
            round(area_slices_EOO_25S, 4)==round(area_km2_EOO_25S, 4)
            
            analise_EOO_25S_summ <- NULL
            for(i in seq_y_num){
              merge_data <- get(paste("analise_EOO_25S","_", i, "_sf_as_df_summ", sep = ""))
              analise_EOO_25S_summ <- rbind(analise_EOO_25S_summ, merge_data)
            }
            analiseEOO_25S <- analise_EOO_25S_summ %>% group_by(mapbiomas_fogo.brazil.collection.10.2020_20m, value) %>% dplyr::summarise(coverage_fraction=sum(coverage_fraction))
          }
          
          analise_EOO <- bind_rows(
            if(exists("analiseEOO_18N")){analiseEOO_18N},
            if(exists("analiseEOO_18S")){analiseEOO_18S},
            if(exists("analiseEOO_19N")){analiseEOO_19N},
            if(exists("analiseEOO_19S")){analiseEOO_19S},
            if(exists("analiseEOO_20N")){analiseEOO_20N},
            if(exists("analiseEOO_20S")){analiseEOO_20S},
            if(exists("analiseEOO_21N")){analiseEOO_21N},
            if(exists("analiseEOO_21S")){analiseEOO_21S},
            if(exists("analiseEOO_22N")){analiseEOO_22N},
            if(exists("analiseEOO_22S")){analiseEOO_22S},
            if(exists("analiseEOO_23N")){analiseEOO_23N},
            if(exists("analiseEOO_23S")){analiseEOO_23S},
            if(exists("analiseEOO_24N")){analiseEOO_24N},
            if(exists("analiseEOO_24S")){analiseEOO_24S},
            if(exists("analiseEOO_25N")){analiseEOO_25N},
            if(exists("analiseEOO_25S")){analiseEOO_25S}
          )
          
          area_EOO_km2_slices <- sum(
            if(exists("area_slices_EOO_18N")){area_slices_EOO_18N},
            if(exists("area_slices_EOO_18S")){area_slices_EOO_18S},
            if(exists("area_slices_EOO_19N")){area_slices_EOO_19N},
            if(exists("area_slices_EOO_19S")){area_slices_EOO_19S},
            if(exists("area_slices_EOO_20N")){area_slices_EOO_20N},
            if(exists("area_slices_EOO_20S")){area_slices_EOO_20S},
            if(exists("area_slices_EOO_21N")){area_slices_EOO_21N},
            if(exists("area_slices_EOO_21S")){area_slices_EOO_21S},
            if(exists("area_slices_EOO_22N")){area_slices_EOO_22N},
            if(exists("area_slices_EOO_22S")){area_slices_EOO_22S},
            if(exists("area_slices_EOO_23N")){area_slices_EOO_23N},
            if(exists("area_slices_EOO_23S")){area_slices_EOO_23S},
            if(exists("area_slices_EOO_24N")){area_slices_EOO_24N},
            if(exists("area_slices_EOO_24S")){area_slices_EOO_24S},
            if(exists("area_slices_EOO_25N")){area_slices_EOO_25N},
            if(exists("area_slices_EOO_25S")){area_slices_EOO_25S}
          )
          
          colnames(analise_EOO) <- c("MapBiomas_Fogo_2020", "Classe", "coverage_fraction")
          
          if(all(is.na(analise_EOO)) == T){
            
            
            
          } else {
            
            analise_EOO <- analise_EOO %>%
              group_by(Classe, MapBiomas_Fogo_2020 ) %>%
              dplyr::summarise(MapBiomas_Fogo_2020, Classe, coverage_fraction = sum(coverage_fraction)) %>%
              unique()
            
            ## Convertendo feições de ameaças de números para texto ####
            analise_EOO$Classe <- sub("^15$", "Pastagem", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^41$", "Outras lavouras temporárias", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^39$", "Soja", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^20$", "Cana-de-açúcar", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^36$", "Lavouras perenes", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^21$", "Mosaico de Agricultura e Pastagem", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^24$", "Infraestrutura urbana", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^30$", "Mineração", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^11$", "Campo Alagado e Área Pantanosa", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^12$", "Formação Campestre", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^13$", "Outras Formações não Florestais", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^19$", "Lavoura Temporária", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^23$", "Praia, Duna e Areal", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^25$", "Outras Áreas não Vegetadas", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^27$", "Não Observado", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^29$", "Afloramento Rochoso", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^31$", "Aquicultura", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^32$", "Apicum", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^33$", "Rio, Lago e Oceano", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^40$", "Arroz", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^46$", "Café", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^47$", "Citrus", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^48$", "Outras Lavouras Perenes", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^49$", "Restinga Arborizada", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^9$", "Floresta Plantada", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^3$", "Floresta", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^4$", "Savana", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^5$", "Mangue", analise_EOO$Classe)
            analise_EOO$Classe <- sub("^0$", "NA", analise_EOO$Classe)
            
            ## Filtragens das ameaças ####
            analise_EOO_urbana <- analise_EOO %>% filter(Classe == "Infraestrutura urbana" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_mineracao <- analise_EOO %>% filter(Classe == "Mineração" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_silvicultura <- analise_EOO %>% filter(Classe == "Floresta Plantada" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_outras_lavouras_temporarias <- analise_EOO %>% filter(Classe == "Outras lavouras temporárias" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_soja <- analise_EOO %>% filter(Classe == "Soja" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_cana <- analise_EOO %>% filter(Classe == "Cana-de-açúcar" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_lavouras_perenes <- analise_EOO %>% filter(Classe == "Lavouras perenes" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_pastagem <- analise_EOO %>% filter(Classe == "Pastagem" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_mosaic_past_agric <- analise_EOO %>% filter(Classe == "Mosaico de Agricultura e Pastagem" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_floresta <- analise_EOO %>% filter(Classe == "Floresta" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_savana <- analise_EOO %>% filter(Classe == "Savana" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_mangue <- analise_EOO %>% filter(Classe == "Mangue" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_alagado_pantanosa <- analise_EOO %>% filter(Classe == "Campo Alagado e Área Pantanosa" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_campos <- analise_EOO %>% filter(Classe == "Formação Campestre" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_outras_nao_florestais <- analise_EOO %>% filter(Classe == "Outras Formações não Florestais" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_lavouras_temporarias <- analise_EOO %>% filter(Classe == "Lavoura Temporária" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_praia_duna_areal <- analise_EOO %>% filter(Classe == "Praia, Duna e Areal" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_outras_nao_vegetadas <- analise_EOO %>% filter(Classe == "Outras Áreas não Vegetadas" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_nao_observado <- analise_EOO %>% filter(Classe == "Não Observado" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_afloramento_rochoso <- analise_EOO %>% filter(Classe == "Afloramento Rochoso" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_aquicultura <- analise_EOO %>% filter(Classe == "Aquicultura" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_apicum <- analise_EOO %>% filter(Classe == "Apicum" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_rio_lago_oceano <- analise_EOO %>% filter(Classe == "Rio, Lago e Oceano" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_arroz <- analise_EOO %>% filter(Classe == "Arroz" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_cafe <- analise_EOO %>% filter(Classe == "Café" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_citrus <- analise_EOO %>% filter(Classe == "Citrus" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_outras_lavouras_perenes <- analise_EOO %>% filter(Classe == "Outras Lavouras Perenes" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_restinga_arborizada <- analise_EOO %>% filter(Classe == "Restinga Arborizada" & MapBiomas_Fogo_2020 == 1)
            analise_EOO_NA <- analise_EOO %>% filter(Classe == "NA" & MapBiomas_Fogo_2020 == 1)
            
            ## Cálculo da área das feições
            sites_EOO_km2 <- area_EOO_km2
            count_sites_EOO_intersected_mapbiomas <- sum(analise_EOO$coverage_fraction)
            
            ## Infraestrutura urbana
            area_EOO_km2_urbana <- analise_EOO_urbana$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_urbana <- area_EOO_km2_urbana*100/sites_EOO_km2
            if(length(area_EOO_km2_urbana) == 0){
              area_EOO_km2_urbana = 0
              porc_area_EOO_km2_urbana = 0
            }
            
            ## Mineração
            area_EOO_km2_mineracao <- analise_EOO_mineracao$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_mineracao <- area_EOO_km2_mineracao*100/sites_EOO_km2
            if(length(area_EOO_km2_mineracao) == 0){
              area_EOO_km2_mineracao = 0
              porc_area_EOO_km2_mineracao = 0
            }
            
            ## Silvicultura
            area_EOO_km2_silvicultura <- analise_EOO_silvicultura$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_silvicultura <- area_EOO_km2_silvicultura*100/sites_EOO_km2
            if(length(area_EOO_km2_silvicultura) == 0){
              area_EOO_km2_silvicultura = 0
              porc_area_EOO_km2_silvicultura = 0
            }
            
            ## Outras lavouras temporárias
            area_EOO_km2_outras_lavouras_temporarias <- analise_EOO_outras_lavouras_temporarias$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_outras_lavouras_temporarias<- area_EOO_km2_outras_lavouras_temporarias*100/sites_EOO_km2
            if(length(area_EOO_km2_outras_lavouras_temporarias) == 0){
              area_EOO_km2_outras_lavouras_temporarias = 0
              porc_area_EOO_km2_outras_lavouras_temporarias = 0
            }
            
            ## Soja
            area_EOO_km2_soja<- analise_EOO_soja$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_soja <- area_EOO_km2_soja*100/sites_EOO_km2
            if(length(area_EOO_km2_soja) == 0){
              area_EOO_km2_soja = 0
              porc_area_EOO_km2_soja = 0
            }
            
            ## Cana-de-açúcar
            area_EOO_km2_cana <- analise_EOO_cana$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_cana <- area_EOO_km2_cana*100/sites_EOO_km2
            if(length(area_EOO_km2_cana) == 0){
              area_EOO_km2_cana = 0
              porc_area_EOO_km2_cana = 0
            }
            
            ## Lavouras perenes
            area_EOO_km2_lavouras_perenes <- analise_EOO_lavouras_perenes$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_lavouras_perenes <- area_EOO_km2_lavouras_perenes*100/sites_EOO_km2
            if(length(area_EOO_km2_lavouras_perenes) == 0){
              area_EOO_km2_lavouras_perenes = 0
              porc_area_EOO_km2_lavouras_perenes = 0
            }
            
            ## Pastagem
            area_EOO_km2_pastagem <- analise_EOO_pastagem$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_pastagem <- area_EOO_km2_pastagem*100/sites_EOO_km2
            if(length(area_EOO_km2_pastagem) == 0){
              area_EOO_km2_pastagem = 0
              porc_area_EOO_km2_pastagem = 0
            }
            
            ## Mosaico mosaic_past_agric e Agricultura
            area_EOO_km2_mosaic_past_agric <- analise_EOO_mosaic_past_agric$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_mosaic_past_agric <- area_EOO_km2_mosaic_past_agric*100/sites_EOO_km2
            if(length(area_EOO_km2_mosaic_past_agric) == 0){
              area_EOO_km2_mosaic_past_agric = 0
              porc_area_EOO_km2_mosaic_past_agric = 0
            }
            
            ## Floresta
            area_EOO_km2_floresta <- analise_EOO_floresta$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_floresta <- area_EOO_km2_floresta*100/sites_EOO_km2
            if(length(area_EOO_km2_floresta) == 0){
              area_EOO_km2_floresta = 0
              porc_area_EOO_km2_floresta = 0
            }
            
            ## Savana
            area_EOO_km2_savana <- analise_EOO_savana$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_savana <- area_EOO_km2_savana*100/sites_EOO_km2
            if(length(area_EOO_km2_savana) == 0){
              area_EOO_km2_savana = 0
              porc_area_EOO_km2_savana = 0
            }
            
            ## Mangue
            area_EOO_km2_mangue <- analise_EOO_mangue$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_mangue <- area_EOO_km2_mangue*100/sites_EOO_km2
            if(length(area_EOO_km2_mangue) == 0){
              area_EOO_km2_mangue = 0
              porc_area_EOO_km2_mangue = 0
            }
            
            ## Campo Alagado e Área Pantanosa
            area_EOO_km2_alagado_pantanosa <- analise_EOO_alagado_pantanosa$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_alagado_pantanosa <- area_EOO_km2_alagado_pantanosa*100/sites_EOO_km2
            if(length(area_EOO_km2_alagado_pantanosa) == 0){
              area_EOO_km2_alagado_pantanosa = 0
              porc_area_EOO_km2_alagado_pantanosa = 0
            }
            
            ## Formação Campestre
            area_EOO_km2_campos <- analise_EOO_campos$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_campos <- area_EOO_km2_campos*100/sites_EOO_km2
            if(length(area_EOO_km2_campos) == 0){
              area_EOO_km2_campos = 0
              porc_area_EOO_km2_campos = 0
            }
            
            ## Outras Formações não outras_nao_florestaisis
            area_EOO_km2_outras_nao_florestais <- analise_EOO_outras_nao_florestais$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_outras_nao_florestais <- area_EOO_km2_outras_nao_florestais*100/sites_EOO_km2
            if(length(area_EOO_km2_outras_nao_florestais) == 0){
              area_EOO_km2_outras_nao_florestais = 0
              porc_area_EOO_km2_outras_nao_florestais = 0
            }
            
            ## Lavoura Temporária
            area_EOO_km2_lavouras_temporarias <- analise_EOO_lavouras_temporarias$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_lavouras_temporarias <- area_EOO_km2_lavouras_temporarias*100/sites_EOO_km2
            if(length(area_EOO_km2_lavouras_temporarias) == 0){
              area_EOO_km2_lavouras_temporarias = 0
              porc_area_EOO_km2_lavouras_temporarias = 0
            }
            
            ## Praia, Duna e Areal
            area_EOO_km2_praia_duna_areal <- analise_EOO_praia_duna_areal$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_praia_duna_areal <- area_EOO_km2_praia_duna_areal*100/sites_EOO_km2
            if(length(area_EOO_km2_praia_duna_areal) == 0){
              area_EOO_km2_praia_duna_areal = 0
              porc_area_EOO_km2_praia_duna_areal = 0
            }
            
            ## Outras Áreas não Vegetadas
            area_EOO_km2_outras_nao_vegetadas <- analise_EOO_outras_nao_vegetadas$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_outras_nao_vegetadas <- area_EOO_km2_outras_nao_vegetadas*100/sites_EOO_km2
            if(length(area_EOO_km2_outras_nao_vegetadas) == 0){
              area_EOO_km2_outras_nao_vegetadas = 0
              porc_area_EOO_km2_outras_nao_vegetadas = 0
            }
            
            ## Não Observado
            area_EOO_km2_nao_observado <- analise_EOO_nao_observado$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_nao_observado <- area_EOO_km2_nao_observado*100/sites_EOO_km2
            if(length(area_EOO_km2_nao_observado) == 0){
              area_EOO_km2_nao_observado = 0
              porc_area_EOO_km2_nao_observado = 0
            }
            
            ## Afloramento Rochoso
            area_EOO_km2_afloramento_rochoso <- analise_EOO_afloramento_rochoso$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_afloramento_rochoso <- area_EOO_km2_afloramento_rochoso*100/sites_EOO_km2
            if(length(area_EOO_km2_afloramento_rochoso) == 0){
              area_EOO_km2_afloramento_rochoso = 0
              porc_area_EOO_km2_afloramento_rochoso = 0
            }
            
            ## Aquicultura
            area_EOO_km2_aquicultura <- analise_EOO_aquicultura$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_aquicultura <- area_EOO_km2_aquicultura*100/sites_EOO_km2
            if(length(area_EOO_km2_aquicultura) == 0){
              area_EOO_km2_aquicultura = 0
              porc_area_EOO_km2_aquicultura = 0
            }
            
            ## Apicum
            area_EOO_km2_apicum <- analise_EOO_apicum$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_apicum <- area_EOO_km2_apicum*100/sites_EOO_km2
            if(length(area_EOO_km2_apicum) == 0){
              area_EOO_km2_apicum = 0
              porc_area_EOO_km2_apicum = 0
            }
            
            ## Rio, Lago e Oceano
            area_EOO_km2_rio_lago_oceano <- analise_EOO_rio_lago_oceano$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_rio_lago_oceano <- area_EOO_km2_rio_lago_oceano*100/sites_EOO_km2
            if(length(area_EOO_km2_rio_lago_oceano) == 0){
              area_EOO_km2_rio_lago_oceano = 0
              porc_area_EOO_km2_rio_lago_oceano = 0
            }
            
            ## Arroz
            area_EOO_km2_arroz <- analise_EOO_arroz$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_arroz <- area_EOO_km2_arroz*100/sites_EOO_km2
            if(length(area_EOO_km2_arroz) == 0){
              area_EOO_km2_arroz = 0
              porc_area_EOO_km2_arroz = 0
            }
            
            ## Café
            area_EOO_km2_cafe <- analise_EOO_cafe$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_cafe <- area_EOO_km2_cafe*100/sites_EOO_km2
            if(length(area_EOO_km2_cafe) == 0){
              area_EOO_km2_cafe = 0
              porc_area_EOO_km2_cafe = 0
            }
            
            ## Citrus
            area_EOO_km2_citrus <- analise_EOO_citrus$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_citrus <- area_EOO_km2_citrus*100/sites_EOO_km2
            if(length(area_EOO_km2_citrus) == 0){
              area_EOO_km2_citrus = 0
              porc_area_EOO_km2_citrus = 0
            }
            
            ## Outras Lavouras Perenes
            area_EOO_km2_outras_lavouras_perenes <- analise_EOO_outras_lavouras_perenes$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_outras_lavouras_perenes <- area_EOO_km2_outras_lavouras_perenes*100/sites_EOO_km2
            if(length(area_EOO_km2_outras_lavouras_perenes) == 0){
              area_EOO_km2_outras_lavouras_perenes = 0
              porc_area_EOO_km2_outras_lavouras_perenes = 0
            }
            
            ## Restinga Arborizada
            area_EOO_km2_restinga_arborizada <- analise_EOO_restinga_arborizada$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_restinga_arborizada <- area_EOO_km2_restinga_arborizada*100/sites_EOO_km2
            if(length(area_EOO_km2_restinga_arborizada) == 0){
              area_EOO_km2_restinga_arborizada = 0
              porc_area_EOO_km2_restinga_arborizada = 0
            }
            
            ## NA
            area_EOO_km2_NA <- analise_EOO_NA$coverage_fraction * sites_EOO_km2/count_sites_EOO_intersected_mapbiomas
            porc_area_EOO_km2_NA <- area_EOO_km2_NA*100/sites_EOO_km2
            if(length(area_EOO_km2_NA) == 0){
              area_EOO_km2_NA = 0
              porc_area_EOO_km2_NA = 0
            }
          }
        }
      }
      
      # AOO ####
      if(is.na(sites_AOO)==T){
        
        final_output_mapbiomas_fogo <- data.frame(Species=ESPECIE, Classe="", Area_AOO_sites_km2_2020=NA, Area_AOO_km2=AOO_area_c_centr_mun, Porcentagem_AOO_2020=NA, AOO_util_km2=NA, Area_EOO_sites_km2_2020=NA, Area_EOO_km2=0, Porcentagem_EOO_2020=NA, Fonte="MapBiomas")
        
      } else{
        
        # Seleção das zonas UTM
        UTM_zone <- unique(sites_AOO$UTMzone)
        CRS <- unique(coords_df_valid_AOO$CRS)
        
        if(length(UTM_zone) == 1){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            if(is.null(MapBiomas_Fogo_Brazil1_chunk) == T){} else{
              #ATUALIZAR!!!!!!! TODOS COM ESSE BLOCO... feito chunk1 UTMzone = 2
              MapBiomas_Fogo_Brazil1 <- NULL
              for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
                
                if(chunk == 0){
                  
                  MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                  
                } else{
                  
                  if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                    
                    MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                    
                  }
                  
                }
                
              }
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
              if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
              if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
              if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
              if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
              
            }
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          if(
            
            exists("MapBiomas_Fogo_Brazil1_chunk") == T &&
            is.null(MapBiomas_Fogo_Brazil1_chunk) == T
            
          ){} else{
            
            # Intersectar Raster e coordenadas
            sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
            sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
            colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
            
          }
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
        }
        
        if(length(UTM_zone) == 2){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            if(is.null(MapBiomas_Fogo_Brazil1_chunk) == T){} else{
              
              MapBiomas_Fogo_Brazil1 <- NULL
              for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
                
                if(chunk == 0){
                  
                  MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                  
                } else{
                  
                  if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                    
                    MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                    
                  }
                  
                }
                
              }
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
              if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
              if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
              if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
              if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
              
            }
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          if(
            
            exists("MapBiomas_Fogo_Brazil1_chunk") == T &&
            is.null(MapBiomas_Fogo_Brazil1_chunk) == T
            
          ){} else{
            
            # Intersectar Raster e coordenadas
            sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
            sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
            colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
            
          }
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
        }
        
        if(length(UTM_zone) == 3){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(nrow(values(MapBiomas_Fogo_Brazil2c)) == 0){
                #### CONTINUAR!!!!!!! ACRESCENTAR ISSO NOS OUTROS!!!!!!!!!
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                } else{
                  
                  if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                    
                  } else{
                    
                    rm(MapBiomas_Fogo_Brazil2c)
                    
                  }
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(nrow(values(MapBiomas_Fogo_Brazil3c)) == 0){
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil3c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
        }
        
        if(length(UTM_zone) == 4){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            if(length(terra::values(MapBiomas_Fogo_Brazil4)) == 0){
              
            } else{
              
              MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
              
              # Intersectar Raster e coordenadas
              sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
              sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
              colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
              
            }
            
          }
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
        }
        
        if(length(UTM_zone) == 5){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                ###### CONTINUAR!!!!! ACRESCENTAR NOS OUTROS: do 3 ao 10 (a,b,c,d,e)
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
        }
        
        if(length(UTM_zone) == 6){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
          # CRS 6
          sites6 <- sites_AOO %>% filter(UTMzone == UTM_zone[6])
          crs(sites6) <- CRS[6]
          sites6_as_sf<-st_as_sf(sites6)
          if(as.numeric(nrow(unique(sites6@coords)))==1|as.numeric(length(unique(sites6@coords[,1])))==1|as.numeric(length(unique(sites6@coords[,2])))==1){
            sites6_grid<-gBuffer(sites6, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites6_grid) <- CRS[6]
            sites6_grid_AOO<-sites6_grid
          } else{
            sites6_grid<-st_make_grid(sites6_as_sf, cellsize = .06)
            sites6_grid_AOO<-sites6_grid[sites6_as_sf]
          }
          # Converter raster para Zona UTM/WGS86
          MapBiomas_Fogo_Brazil6 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil6) <- CRS[6]
          
          MapBiomas_LandUse_Brazil6 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil6) <- CRS[6]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites6_grid_AOO)[1] == "sfc_POLYGON"){
            sites6_grid_AOO <- as_Spatial(sites6_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil6 <- terra::crop(MapBiomas_Fogo_Brazil6, extent(sites6_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,])/6
            
            MapBiomas_Fogo_Brazil6a <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6a)
              
            } else{
              
              MapBiomas_Fogo_Brazil6a <- terra::mask(MapBiomas_Fogo_Brazil6a, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6a))
              
              if(1 %in% MapBiomas_Fogo_Brazil6a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6b <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6b)
              
            } else{
              
              MapBiomas_Fogo_Brazil6b <- terra::mask(MapBiomas_Fogo_Brazil6b, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6b))
              
              if(1 %in% MapBiomas_Fogo_Brazil6b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6c <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6c)
              
            } else{
              
              MapBiomas_Fogo_Brazil6c <- terra::mask(MapBiomas_Fogo_Brazil6c, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6c))
              
              if(1 %in% MapBiomas_Fogo_Brazil6c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6d <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6d)
              
            } else{
              
              MapBiomas_Fogo_Brazil6d <- terra::mask(MapBiomas_Fogo_Brazil6d, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6d))
              
              if(1 %in% MapBiomas_Fogo_Brazil6d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6e <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6e)
              
            } else{
              
              MapBiomas_Fogo_Brazil6e <- terra::mask(MapBiomas_Fogo_Brazil6e, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6e))
              
              if(1 %in% MapBiomas_Fogo_Brazil6e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil6)
            
            MapBiomas_Fogo_Brazil6_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil6a") == T){"MapBiomas_Fogo_Brazil6a"},
              if(exists("MapBiomas_Fogo_Brazil6b") == T){"MapBiomas_Fogo_Brazil6b"},
              if(exists("MapBiomas_Fogo_Brazil6c") == T){"MapBiomas_Fogo_Brazil6c"},
              if(exists("MapBiomas_Fogo_Brazil6d") == T){"MapBiomas_Fogo_Brazil6d"},
              if(exists("MapBiomas_Fogo_Brazil6e") == T){"MapBiomas_Fogo_Brazil6e"}
              
            )
            MapBiomas_Fogo_Brazil6_chunk_n <- 0:length(MapBiomas_Fogo_Brazil6_chunk)
            
            MapBiomas_Fogo_Brazil6 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil6_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil6 <- get(MapBiomas_Fogo_Brazil6_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil6_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil6 <- terra::union(MapBiomas_Fogo_Brazil6, get(MapBiomas_Fogo_Brazil6_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil6a") == T) {rm(MapBiomas_Fogo_Brazil6a)}
            if(exists("MapBiomas_Fogo_Brazil6b") == T) {rm(MapBiomas_Fogo_Brazil6b)}
            if(exists("MapBiomas_Fogo_Brazil6c") == T) {rm(MapBiomas_Fogo_Brazil6c)}
            if(exists("MapBiomas_Fogo_Brazil6d") == T) {rm(MapBiomas_Fogo_Brazil6d)}
            if(exists("MapBiomas_Fogo_Brazil6e") == T) {rm(MapBiomas_Fogo_Brazil6e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil6 <- terra::mask(MapBiomas_Fogo_Brazil6, sites6_grid_AOO)
            MapBiomas_Fogo_Brazil6 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil6), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites6_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil6, st_as_sf(MapBiomas_Fogo_Brazil6), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites6_intersected_mapbiomas_df <- do.call(rbind, sites6_intersected_mapbiomas)
          colnames(sites6_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil6)
          rm(MapBiomas_LandUse_Brazil6)
          
        }
        
        if(length(UTM_zone) == 7){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
          # CRS 6
          sites6 <- sites_AOO %>% filter(UTMzone == UTM_zone[6])
          crs(sites6) <- CRS[6]
          sites6_as_sf<-st_as_sf(sites6)
          if(as.numeric(nrow(unique(sites6@coords)))==1|as.numeric(length(unique(sites6@coords[,1])))==1|as.numeric(length(unique(sites6@coords[,2])))==1){
            sites6_grid<-gBuffer(sites6, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites6_grid) <- CRS[6]
            sites6_grid_AOO<-sites6_grid
          } else{
            sites6_grid<-st_make_grid(sites6_as_sf, cellsize = .06)
            sites6_grid_AOO<-sites6_grid[sites6_as_sf]
          }
          # Converter raster para Zona UTM/WGS86
          MapBiomas_Fogo_Brazil6 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil6) <- CRS[6]
          
          MapBiomas_LandUse_Brazil6 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil6) <- CRS[6]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites6_grid_AOO)[1] == "sfc_POLYGON"){
            sites6_grid_AOO <- as_Spatial(sites6_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil6 <- terra::crop(MapBiomas_Fogo_Brazil6, extent(sites6_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,])/6
            
            MapBiomas_Fogo_Brazil6a <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6a)
              
            } else{
              
              MapBiomas_Fogo_Brazil6a <- terra::mask(MapBiomas_Fogo_Brazil6a, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6a))
              
              if(1 %in% MapBiomas_Fogo_Brazil6a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6b <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6b)
              
            } else{
              
              MapBiomas_Fogo_Brazil6b <- terra::mask(MapBiomas_Fogo_Brazil6b, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6b))
              
              if(1 %in% MapBiomas_Fogo_Brazil6b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6c <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6c)
              
            } else{
              
              MapBiomas_Fogo_Brazil6c <- terra::mask(MapBiomas_Fogo_Brazil6c, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6c))
              
              if(1 %in% MapBiomas_Fogo_Brazil6c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6d <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6d)
              
            } else{
              
              MapBiomas_Fogo_Brazil6d <- terra::mask(MapBiomas_Fogo_Brazil6d, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6d))
              
              if(1 %in% MapBiomas_Fogo_Brazil6d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6e <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6e)
              
            } else{
              
              MapBiomas_Fogo_Brazil6e <- terra::mask(MapBiomas_Fogo_Brazil6e, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6e))
              
              if(1 %in% MapBiomas_Fogo_Brazil6e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil6)
            
            MapBiomas_Fogo_Brazil6_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil6a") == T){"MapBiomas_Fogo_Brazil6a"},
              if(exists("MapBiomas_Fogo_Brazil6b") == T){"MapBiomas_Fogo_Brazil6b"},
              if(exists("MapBiomas_Fogo_Brazil6c") == T){"MapBiomas_Fogo_Brazil6c"},
              if(exists("MapBiomas_Fogo_Brazil6d") == T){"MapBiomas_Fogo_Brazil6d"},
              if(exists("MapBiomas_Fogo_Brazil6e") == T){"MapBiomas_Fogo_Brazil6e"}
              
            )
            MapBiomas_Fogo_Brazil6_chunk_n <- 0:length(MapBiomas_Fogo_Brazil6_chunk)
            
            MapBiomas_Fogo_Brazil6 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil6_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil6 <- get(MapBiomas_Fogo_Brazil6_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil6_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil6 <- terra::union(MapBiomas_Fogo_Brazil6, get(MapBiomas_Fogo_Brazil6_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil6a") == T) {rm(MapBiomas_Fogo_Brazil6a)}
            if(exists("MapBiomas_Fogo_Brazil6b") == T) {rm(MapBiomas_Fogo_Brazil6b)}
            if(exists("MapBiomas_Fogo_Brazil6c") == T) {rm(MapBiomas_Fogo_Brazil6c)}
            if(exists("MapBiomas_Fogo_Brazil6d") == T) {rm(MapBiomas_Fogo_Brazil6d)}
            if(exists("MapBiomas_Fogo_Brazil6e") == T) {rm(MapBiomas_Fogo_Brazil6e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil6 <- terra::mask(MapBiomas_Fogo_Brazil6, sites6_grid_AOO)
            MapBiomas_Fogo_Brazil6 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil6), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites6_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil6, st_as_sf(MapBiomas_Fogo_Brazil6), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites6_intersected_mapbiomas_df <- do.call(rbind, sites6_intersected_mapbiomas)
          colnames(sites6_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil6)
          rm(MapBiomas_LandUse_Brazil6)
          
          # CRS 7
          sites7 <- sites_AOO %>% filter(UTMzone == UTM_zone[7])
          crs(sites7) <- CRS[7]
          sites7_as_sf<-st_as_sf(sites7)
          if(as.numeric(nrow(unique(sites7@coords)))==1|as.numeric(length(unique(sites7@coords[,1])))==1|as.numeric(length(unique(sites7@coords[,2])))==1){
            sites7_grid<-gBuffer(sites7, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites7_grid) <- CRS[7]
            sites7_grid_AOO<-sites7_grid
          } else{
            sites7_grid<-st_make_grid(sites7_as_sf, cellsize = .07)
            sites7_grid_AOO<-sites7_grid[sites7_as_sf]
          }
          # Converter raster para Zona UTM/WGS87
          MapBiomas_Fogo_Brazil7 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil7) <- CRS[7]
          
          MapBiomas_LandUse_Brazil7 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil7) <- CRS[7]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites7_grid_AOO)[1] == "sfc_POLYGON"){
            sites7_grid_AOO <- as_Spatial(sites7_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil7 <- terra::crop(MapBiomas_Fogo_Brazil7, extent(sites7_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,])/6
            
            MapBiomas_Fogo_Brazil7a <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7a)
              
            } else{
              
              MapBiomas_Fogo_Brazil7a <- terra::mask(MapBiomas_Fogo_Brazil7a, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7a))
              
              if(1 %in% MapBiomas_Fogo_Brazil7a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7b <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7b)
              
            } else{
              
              MapBiomas_Fogo_Brazil7b <- terra::mask(MapBiomas_Fogo_Brazil7b, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7b))
              
              if(1 %in% MapBiomas_Fogo_Brazil7b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7c <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7c)
              
            } else{
              
              MapBiomas_Fogo_Brazil7c <- terra::mask(MapBiomas_Fogo_Brazil7c, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7c))
              
              if(1 %in% MapBiomas_Fogo_Brazil7c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7d <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7d)
              
            } else{
              
              MapBiomas_Fogo_Brazil7d <- terra::mask(MapBiomas_Fogo_Brazil7d, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7d))
              
              if(1 %in% MapBiomas_Fogo_Brazil7d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7e <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7e)
              
            } else{
              
              MapBiomas_Fogo_Brazil7e <- terra::mask(MapBiomas_Fogo_Brazil7e, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7e))
              
              if(1 %in% MapBiomas_Fogo_Brazil7e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil7)
            
            MapBiomas_Fogo_Brazil7_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil7a") == T){"MapBiomas_Fogo_Brazil7a"},
              if(exists("MapBiomas_Fogo_Brazil7b") == T){"MapBiomas_Fogo_Brazil7b"},
              if(exists("MapBiomas_Fogo_Brazil7c") == T){"MapBiomas_Fogo_Brazil7c"},
              if(exists("MapBiomas_Fogo_Brazil7d") == T){"MapBiomas_Fogo_Brazil7d"},
              if(exists("MapBiomas_Fogo_Brazil7e") == T){"MapBiomas_Fogo_Brazil7e"}
              
            )
            MapBiomas_Fogo_Brazil7_chunk_n <- 0:length(MapBiomas_Fogo_Brazil7_chunk)
            
            MapBiomas_Fogo_Brazil7 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil7_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil7 <- get(MapBiomas_Fogo_Brazil7_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil7_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil7 <- terra::union(MapBiomas_Fogo_Brazil7, get(MapBiomas_Fogo_Brazil7_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil7a") == T) {rm(MapBiomas_Fogo_Brazil7a)}
            if(exists("MapBiomas_Fogo_Brazil7b") == T) {rm(MapBiomas_Fogo_Brazil7b)}
            if(exists("MapBiomas_Fogo_Brazil7c") == T) {rm(MapBiomas_Fogo_Brazil7c)}
            if(exists("MapBiomas_Fogo_Brazil7d") == T) {rm(MapBiomas_Fogo_Brazil7d)}
            if(exists("MapBiomas_Fogo_Brazil7e") == T) {rm(MapBiomas_Fogo_Brazil7e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil7 <- terra::mask(MapBiomas_Fogo_Brazil7, sites7_grid_AOO)
            MapBiomas_Fogo_Brazil7 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil7), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites7_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil7, st_as_sf(MapBiomas_Fogo_Brazil7), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites7_intersected_mapbiomas_df <- do.call(rbind, sites7_intersected_mapbiomas)
          colnames(sites7_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil7)
          rm(MapBiomas_LandUse_Brazil7)
          
        }
        
        if(length(UTM_zone) == 8){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
          # CRS 6
          sites6 <- sites_AOO %>% filter(UTMzone == UTM_zone[6])
          crs(sites6) <- CRS[6]
          sites6_as_sf<-st_as_sf(sites6)
          if(as.numeric(nrow(unique(sites6@coords)))==1|as.numeric(length(unique(sites6@coords[,1])))==1|as.numeric(length(unique(sites6@coords[,2])))==1){
            sites6_grid<-gBuffer(sites6, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites6_grid) <- CRS[6]
            sites6_grid_AOO<-sites6_grid
          } else{
            sites6_grid<-st_make_grid(sites6_as_sf, cellsize = .06)
            sites6_grid_AOO<-sites6_grid[sites6_as_sf]
          }
          # Converter raster para Zona UTM/WGS86
          MapBiomas_Fogo_Brazil6 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil6) <- CRS[6]
          
          MapBiomas_LandUse_Brazil6 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil6) <- CRS[6]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites6_grid_AOO)[1] == "sfc_POLYGON"){
            sites6_grid_AOO <- as_Spatial(sites6_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil6 <- terra::crop(MapBiomas_Fogo_Brazil6, extent(sites6_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,])/6
            
            MapBiomas_Fogo_Brazil6a <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6a)
              
            } else{
              
              MapBiomas_Fogo_Brazil6a <- terra::mask(MapBiomas_Fogo_Brazil6a, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6a))
              
              if(1 %in% MapBiomas_Fogo_Brazil6a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6b <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6b)
              
            } else{
              
              MapBiomas_Fogo_Brazil6b <- terra::mask(MapBiomas_Fogo_Brazil6b, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6b))
              
              if(1 %in% MapBiomas_Fogo_Brazil6b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6c <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6c)
              
            } else{
              
              MapBiomas_Fogo_Brazil6c <- terra::mask(MapBiomas_Fogo_Brazil6c, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6c))
              
              if(1 %in% MapBiomas_Fogo_Brazil6c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6d <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6d)
              
            } else{
              
              MapBiomas_Fogo_Brazil6d <- terra::mask(MapBiomas_Fogo_Brazil6d, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6d))
              
              if(1 %in% MapBiomas_Fogo_Brazil6d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6e <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6e)
              
            } else{
              
              MapBiomas_Fogo_Brazil6e <- terra::mask(MapBiomas_Fogo_Brazil6e, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6e))
              
              if(1 %in% MapBiomas_Fogo_Brazil6e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil6)
            
            MapBiomas_Fogo_Brazil6_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil6a") == T){"MapBiomas_Fogo_Brazil6a"},
              if(exists("MapBiomas_Fogo_Brazil6b") == T){"MapBiomas_Fogo_Brazil6b"},
              if(exists("MapBiomas_Fogo_Brazil6c") == T){"MapBiomas_Fogo_Brazil6c"},
              if(exists("MapBiomas_Fogo_Brazil6d") == T){"MapBiomas_Fogo_Brazil6d"},
              if(exists("MapBiomas_Fogo_Brazil6e") == T){"MapBiomas_Fogo_Brazil6e"}
              
            )
            MapBiomas_Fogo_Brazil6_chunk_n <- 0:length(MapBiomas_Fogo_Brazil6_chunk)
            
            MapBiomas_Fogo_Brazil6 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil6_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil6 <- get(MapBiomas_Fogo_Brazil6_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil6_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil6 <- terra::union(MapBiomas_Fogo_Brazil6, get(MapBiomas_Fogo_Brazil6_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil6a") == T) {rm(MapBiomas_Fogo_Brazil6a)}
            if(exists("MapBiomas_Fogo_Brazil6b") == T) {rm(MapBiomas_Fogo_Brazil6b)}
            if(exists("MapBiomas_Fogo_Brazil6c") == T) {rm(MapBiomas_Fogo_Brazil6c)}
            if(exists("MapBiomas_Fogo_Brazil6d") == T) {rm(MapBiomas_Fogo_Brazil6d)}
            if(exists("MapBiomas_Fogo_Brazil6e") == T) {rm(MapBiomas_Fogo_Brazil6e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil6 <- terra::mask(MapBiomas_Fogo_Brazil6, sites6_grid_AOO)
            MapBiomas_Fogo_Brazil6 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil6), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites6_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil6, st_as_sf(MapBiomas_Fogo_Brazil6), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites6_intersected_mapbiomas_df <- do.call(rbind, sites6_intersected_mapbiomas)
          colnames(sites6_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil6)
          rm(MapBiomas_LandUse_Brazil6)
          
          # CRS 7
          sites7 <- sites_AOO %>% filter(UTMzone == UTM_zone[7])
          crs(sites7) <- CRS[7]
          sites7_as_sf<-st_as_sf(sites7)
          if(as.numeric(nrow(unique(sites7@coords)))==1|as.numeric(length(unique(sites7@coords[,1])))==1|as.numeric(length(unique(sites7@coords[,2])))==1){
            sites7_grid<-gBuffer(sites7, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites7_grid) <- CRS[7]
            sites7_grid_AOO<-sites7_grid
          } else{
            sites7_grid<-st_make_grid(sites7_as_sf, cellsize = .07)
            sites7_grid_AOO<-sites7_grid[sites7_as_sf]
          }
          # Converter raster para Zona UTM/WGS87
          MapBiomas_Fogo_Brazil7 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil7) <- CRS[7]
          
          MapBiomas_LandUse_Brazil7 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil7) <- CRS[7]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites7_grid_AOO)[1] == "sfc_POLYGON"){
            sites7_grid_AOO <- as_Spatial(sites7_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil7 <- terra::crop(MapBiomas_Fogo_Brazil7, extent(sites7_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,])/6
            
            MapBiomas_Fogo_Brazil7a <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7a)
              
            } else{
              
              MapBiomas_Fogo_Brazil7a <- terra::mask(MapBiomas_Fogo_Brazil7a, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7a))
              
              if(1 %in% MapBiomas_Fogo_Brazil7a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7b <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7b)
              
            } else{
              
              MapBiomas_Fogo_Brazil7b <- terra::mask(MapBiomas_Fogo_Brazil7b, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7b))
              
              if(1 %in% MapBiomas_Fogo_Brazil7b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7c <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7c)
              
            } else{
              
              MapBiomas_Fogo_Brazil7c <- terra::mask(MapBiomas_Fogo_Brazil7c, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7c))
              
              if(1 %in% MapBiomas_Fogo_Brazil7c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7d <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7d)
              
            } else{
              
              MapBiomas_Fogo_Brazil7d <- terra::mask(MapBiomas_Fogo_Brazil7d, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7d))
              
              if(1 %in% MapBiomas_Fogo_Brazil7d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7e <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7e)
              
            } else{
              
              MapBiomas_Fogo_Brazil7e <- terra::mask(MapBiomas_Fogo_Brazil7e, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7e))
              
              if(1 %in% MapBiomas_Fogo_Brazil7e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil7)
            
            MapBiomas_Fogo_Brazil7_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil7a") == T){"MapBiomas_Fogo_Brazil7a"},
              if(exists("MapBiomas_Fogo_Brazil7b") == T){"MapBiomas_Fogo_Brazil7b"},
              if(exists("MapBiomas_Fogo_Brazil7c") == T){"MapBiomas_Fogo_Brazil7c"},
              if(exists("MapBiomas_Fogo_Brazil7d") == T){"MapBiomas_Fogo_Brazil7d"},
              if(exists("MapBiomas_Fogo_Brazil7e") == T){"MapBiomas_Fogo_Brazil7e"}
              
            )
            MapBiomas_Fogo_Brazil7_chunk_n <- 0:length(MapBiomas_Fogo_Brazil7_chunk)
            
            MapBiomas_Fogo_Brazil7 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil7_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil7 <- get(MapBiomas_Fogo_Brazil7_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil7_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil7 <- terra::union(MapBiomas_Fogo_Brazil7, get(MapBiomas_Fogo_Brazil7_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil7a") == T) {rm(MapBiomas_Fogo_Brazil7a)}
            if(exists("MapBiomas_Fogo_Brazil7b") == T) {rm(MapBiomas_Fogo_Brazil7b)}
            if(exists("MapBiomas_Fogo_Brazil7c") == T) {rm(MapBiomas_Fogo_Brazil7c)}
            if(exists("MapBiomas_Fogo_Brazil7d") == T) {rm(MapBiomas_Fogo_Brazil7d)}
            if(exists("MapBiomas_Fogo_Brazil7e") == T) {rm(MapBiomas_Fogo_Brazil7e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil7 <- terra::mask(MapBiomas_Fogo_Brazil7, sites7_grid_AOO)
            MapBiomas_Fogo_Brazil7 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil7), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites7_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil7, st_as_sf(MapBiomas_Fogo_Brazil7), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites7_intersected_mapbiomas_df <- do.call(rbind, sites7_intersected_mapbiomas)
          colnames(sites7_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil7)
          rm(MapBiomas_LandUse_Brazil7)
          
          # CRS 8
          sites8 <- sites_AOO %>% filter(UTMzone == UTM_zone[8])
          crs(sites8) <- CRS[8]
          sites8_as_sf<-st_as_sf(sites8)
          if(as.numeric(nrow(unique(sites8@coords)))==1|as.numeric(length(unique(sites8@coords[,1])))==1|as.numeric(length(unique(sites8@coords[,2])))==1){
            sites8_grid<-gBuffer(sites8, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites8_grid) <- CRS[8]
            sites8_grid_AOO<-sites8_grid
          } else{
            sites8_grid<-st_make_grid(sites8_as_sf, cellsize = .08)
            sites8_grid_AOO<-sites8_grid[sites8_as_sf]
          }
          # Converter raster para Zona UTM/WGS88
          MapBiomas_Fogo_Brazil8 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil8) <- CRS[8]
          
          MapBiomas_LandUse_Brazil8 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil8) <- CRS[8]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites8_grid_AOO)[1] == "sfc_POLYGON"){
            sites8_grid_AOO <- as_Spatial(sites8_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil8 <- terra::crop(MapBiomas_Fogo_Brazil8, extent(sites8_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,])/6
            
            MapBiomas_Fogo_Brazil8a <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8a)
              
            } else{
              
              MapBiomas_Fogo_Brazil8a <- terra::mask(MapBiomas_Fogo_Brazil8a, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8a))
              
              if(1 %in% MapBiomas_Fogo_Brazil8a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8b <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8b)
              
            } else{
              
              MapBiomas_Fogo_Brazil8b <- terra::mask(MapBiomas_Fogo_Brazil8b, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8b))
              
              if(1 %in% MapBiomas_Fogo_Brazil8b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8c <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8c)
              
            } else{
              
              MapBiomas_Fogo_Brazil8c <- terra::mask(MapBiomas_Fogo_Brazil8c, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8c))
              
              if(1 %in% MapBiomas_Fogo_Brazil8c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8d <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8d)
              
            } else{
              
              MapBiomas_Fogo_Brazil8d <- terra::mask(MapBiomas_Fogo_Brazil8d, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8d))
              
              if(1 %in% MapBiomas_Fogo_Brazil8d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8e <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8e)
              
            } else{
              
              MapBiomas_Fogo_Brazil8e <- terra::mask(MapBiomas_Fogo_Brazil8e, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8e))
              
              if(1 %in% MapBiomas_Fogo_Brazil8e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil8)
            
            MapBiomas_Fogo_Brazil8_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil8a") == T){"MapBiomas_Fogo_Brazil8a"},
              if(exists("MapBiomas_Fogo_Brazil8b") == T){"MapBiomas_Fogo_Brazil8b"},
              if(exists("MapBiomas_Fogo_Brazil8c") == T){"MapBiomas_Fogo_Brazil8c"},
              if(exists("MapBiomas_Fogo_Brazil8d") == T){"MapBiomas_Fogo_Brazil8d"},
              if(exists("MapBiomas_Fogo_Brazil8e") == T){"MapBiomas_Fogo_Brazil8e"}
              
            )
            MapBiomas_Fogo_Brazil8_chunk_n <- 0:length(MapBiomas_Fogo_Brazil8_chunk)
            
            MapBiomas_Fogo_Brazil8 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil8_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil8 <- get(MapBiomas_Fogo_Brazil8_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil8_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil8 <- terra::union(MapBiomas_Fogo_Brazil8, get(MapBiomas_Fogo_Brazil8_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil8a") == T) {rm(MapBiomas_Fogo_Brazil8a)}
            if(exists("MapBiomas_Fogo_Brazil8b") == T) {rm(MapBiomas_Fogo_Brazil8b)}
            if(exists("MapBiomas_Fogo_Brazil8c") == T) {rm(MapBiomas_Fogo_Brazil8c)}
            if(exists("MapBiomas_Fogo_Brazil8d") == T) {rm(MapBiomas_Fogo_Brazil8d)}
            if(exists("MapBiomas_Fogo_Brazil8e") == T) {rm(MapBiomas_Fogo_Brazil8e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil8 <- terra::mask(MapBiomas_Fogo_Brazil8, sites8_grid_AOO)
            MapBiomas_Fogo_Brazil8 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil8), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites8_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil8, st_as_sf(MapBiomas_Fogo_Brazil8), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites8_intersected_mapbiomas_df <- do.call(rbind, sites8_intersected_mapbiomas)
          colnames(sites8_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil8)
          rm(MapBiomas_LandUse_Brazil8)
          
        }
        
        if(length(UTM_zone) == 9){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
          # CRS 6
          sites6 <- sites_AOO %>% filter(UTMzone == UTM_zone[6])
          crs(sites6) <- CRS[6]
          sites6_as_sf<-st_as_sf(sites6)
          if(as.numeric(nrow(unique(sites6@coords)))==1|as.numeric(length(unique(sites6@coords[,1])))==1|as.numeric(length(unique(sites6@coords[,2])))==1){
            sites6_grid<-gBuffer(sites6, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites6_grid) <- CRS[6]
            sites6_grid_AOO<-sites6_grid
          } else{
            sites6_grid<-st_make_grid(sites6_as_sf, cellsize = .06)
            sites6_grid_AOO<-sites6_grid[sites6_as_sf]
          }
          # Converter raster para Zona UTM/WGS86
          MapBiomas_Fogo_Brazil6 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil6) <- CRS[6]
          
          MapBiomas_LandUse_Brazil6 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil6) <- CRS[6]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites6_grid_AOO)[1] == "sfc_POLYGON"){
            sites6_grid_AOO <- as_Spatial(sites6_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil6 <- terra::crop(MapBiomas_Fogo_Brazil6, extent(sites6_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,])/6
            
            MapBiomas_Fogo_Brazil6a <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6a)
              
            } else{
              
              MapBiomas_Fogo_Brazil6a <- terra::mask(MapBiomas_Fogo_Brazil6a, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6a))
              
              if(1 %in% MapBiomas_Fogo_Brazil6a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6b <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6b)
              
            } else{
              
              MapBiomas_Fogo_Brazil6b <- terra::mask(MapBiomas_Fogo_Brazil6b, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6b))
              
              if(1 %in% MapBiomas_Fogo_Brazil6b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6c <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6c)
              
            } else{
              
              MapBiomas_Fogo_Brazil6c <- terra::mask(MapBiomas_Fogo_Brazil6c, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6c))
              
              if(1 %in% MapBiomas_Fogo_Brazil6c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6d <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6d)
              
            } else{
              
              MapBiomas_Fogo_Brazil6d <- terra::mask(MapBiomas_Fogo_Brazil6d, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6d))
              
              if(1 %in% MapBiomas_Fogo_Brazil6d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6e <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6e)
              
            } else{
              
              MapBiomas_Fogo_Brazil6e <- terra::mask(MapBiomas_Fogo_Brazil6e, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6e))
              
              if(1 %in% MapBiomas_Fogo_Brazil6e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil6)
            
            MapBiomas_Fogo_Brazil6_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil6a") == T){"MapBiomas_Fogo_Brazil6a"},
              if(exists("MapBiomas_Fogo_Brazil6b") == T){"MapBiomas_Fogo_Brazil6b"},
              if(exists("MapBiomas_Fogo_Brazil6c") == T){"MapBiomas_Fogo_Brazil6c"},
              if(exists("MapBiomas_Fogo_Brazil6d") == T){"MapBiomas_Fogo_Brazil6d"},
              if(exists("MapBiomas_Fogo_Brazil6e") == T){"MapBiomas_Fogo_Brazil6e"}
              
            )
            MapBiomas_Fogo_Brazil6_chunk_n <- 0:length(MapBiomas_Fogo_Brazil6_chunk)
            
            MapBiomas_Fogo_Brazil6 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil6_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil6 <- get(MapBiomas_Fogo_Brazil6_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil6_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil6 <- terra::union(MapBiomas_Fogo_Brazil6, get(MapBiomas_Fogo_Brazil6_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil6a") == T) {rm(MapBiomas_Fogo_Brazil6a)}
            if(exists("MapBiomas_Fogo_Brazil6b") == T) {rm(MapBiomas_Fogo_Brazil6b)}
            if(exists("MapBiomas_Fogo_Brazil6c") == T) {rm(MapBiomas_Fogo_Brazil6c)}
            if(exists("MapBiomas_Fogo_Brazil6d") == T) {rm(MapBiomas_Fogo_Brazil6d)}
            if(exists("MapBiomas_Fogo_Brazil6e") == T) {rm(MapBiomas_Fogo_Brazil6e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil6 <- terra::mask(MapBiomas_Fogo_Brazil6, sites6_grid_AOO)
            MapBiomas_Fogo_Brazil6 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil6), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites6_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil6, st_as_sf(MapBiomas_Fogo_Brazil6), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites6_intersected_mapbiomas_df <- do.call(rbind, sites6_intersected_mapbiomas)
          colnames(sites6_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil6)
          rm(MapBiomas_LandUse_Brazil6)
          
          # CRS 7
          sites7 <- sites_AOO %>% filter(UTMzone == UTM_zone[7])
          crs(sites7) <- CRS[7]
          sites7_as_sf<-st_as_sf(sites7)
          if(as.numeric(nrow(unique(sites7@coords)))==1|as.numeric(length(unique(sites7@coords[,1])))==1|as.numeric(length(unique(sites7@coords[,2])))==1){
            sites7_grid<-gBuffer(sites7, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites7_grid) <- CRS[7]
            sites7_grid_AOO<-sites7_grid
          } else{
            sites7_grid<-st_make_grid(sites7_as_sf, cellsize = .07)
            sites7_grid_AOO<-sites7_grid[sites7_as_sf]
          }
          # Converter raster para Zona UTM/WGS87
          MapBiomas_Fogo_Brazil7 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil7) <- CRS[7]
          
          MapBiomas_LandUse_Brazil7 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil7) <- CRS[7]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites7_grid_AOO)[1] == "sfc_POLYGON"){
            sites7_grid_AOO <- as_Spatial(sites7_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil7 <- terra::crop(MapBiomas_Fogo_Brazil7, extent(sites7_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,])/6
            
            MapBiomas_Fogo_Brazil7a <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7a)
              
            } else{
              
              MapBiomas_Fogo_Brazil7a <- terra::mask(MapBiomas_Fogo_Brazil7a, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7a))
              
              if(1 %in% MapBiomas_Fogo_Brazil7a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7b <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7b)
              
            } else{
              
              MapBiomas_Fogo_Brazil7b <- terra::mask(MapBiomas_Fogo_Brazil7b, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7b))
              
              if(1 %in% MapBiomas_Fogo_Brazil7b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7c <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7c)
              
            } else{
              
              MapBiomas_Fogo_Brazil7c <- terra::mask(MapBiomas_Fogo_Brazil7c, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7c))
              
              if(1 %in% MapBiomas_Fogo_Brazil7c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7d <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7d)
              
            } else{
              
              MapBiomas_Fogo_Brazil7d <- terra::mask(MapBiomas_Fogo_Brazil7d, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7d))
              
              if(1 %in% MapBiomas_Fogo_Brazil7d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7e <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7e)
              
            } else{
              
              MapBiomas_Fogo_Brazil7e <- terra::mask(MapBiomas_Fogo_Brazil7e, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7e))
              
              if(1 %in% MapBiomas_Fogo_Brazil7e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil7)
            
            MapBiomas_Fogo_Brazil7_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil7a") == T){"MapBiomas_Fogo_Brazil7a"},
              if(exists("MapBiomas_Fogo_Brazil7b") == T){"MapBiomas_Fogo_Brazil7b"},
              if(exists("MapBiomas_Fogo_Brazil7c") == T){"MapBiomas_Fogo_Brazil7c"},
              if(exists("MapBiomas_Fogo_Brazil7d") == T){"MapBiomas_Fogo_Brazil7d"},
              if(exists("MapBiomas_Fogo_Brazil7e") == T){"MapBiomas_Fogo_Brazil7e"}
              
            )
            MapBiomas_Fogo_Brazil7_chunk_n <- 0:length(MapBiomas_Fogo_Brazil7_chunk)
            
            MapBiomas_Fogo_Brazil7 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil7_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil7 <- get(MapBiomas_Fogo_Brazil7_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil7_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil7 <- terra::union(MapBiomas_Fogo_Brazil7, get(MapBiomas_Fogo_Brazil7_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil7a") == T) {rm(MapBiomas_Fogo_Brazil7a)}
            if(exists("MapBiomas_Fogo_Brazil7b") == T) {rm(MapBiomas_Fogo_Brazil7b)}
            if(exists("MapBiomas_Fogo_Brazil7c") == T) {rm(MapBiomas_Fogo_Brazil7c)}
            if(exists("MapBiomas_Fogo_Brazil7d") == T) {rm(MapBiomas_Fogo_Brazil7d)}
            if(exists("MapBiomas_Fogo_Brazil7e") == T) {rm(MapBiomas_Fogo_Brazil7e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil7 <- terra::mask(MapBiomas_Fogo_Brazil7, sites7_grid_AOO)
            MapBiomas_Fogo_Brazil7 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil7), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites7_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil7, st_as_sf(MapBiomas_Fogo_Brazil7), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites7_intersected_mapbiomas_df <- do.call(rbind, sites7_intersected_mapbiomas)
          colnames(sites7_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil7)
          rm(MapBiomas_LandUse_Brazil7)
          
          # CRS 8
          sites8 <- sites_AOO %>% filter(UTMzone == UTM_zone[8])
          crs(sites8) <- CRS[8]
          sites8_as_sf<-st_as_sf(sites8)
          if(as.numeric(nrow(unique(sites8@coords)))==1|as.numeric(length(unique(sites8@coords[,1])))==1|as.numeric(length(unique(sites8@coords[,2])))==1){
            sites8_grid<-gBuffer(sites8, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites8_grid) <- CRS[8]
            sites8_grid_AOO<-sites8_grid
          } else{
            sites8_grid<-st_make_grid(sites8_as_sf, cellsize = .08)
            sites8_grid_AOO<-sites8_grid[sites8_as_sf]
          }
          # Converter raster para Zona UTM/WGS88
          MapBiomas_Fogo_Brazil8 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil8) <- CRS[8]
          
          MapBiomas_LandUse_Brazil8 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil8) <- CRS[8]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites8_grid_AOO)[1] == "sfc_POLYGON"){
            sites8_grid_AOO <- as_Spatial(sites8_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil8 <- terra::crop(MapBiomas_Fogo_Brazil8, extent(sites8_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,])/6
            
            MapBiomas_Fogo_Brazil8a <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8a)
              
            } else{
              
              MapBiomas_Fogo_Brazil8a <- terra::mask(MapBiomas_Fogo_Brazil8a, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8a))
              
              if(1 %in% MapBiomas_Fogo_Brazil8a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8b <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8b)
              
            } else{
              
              MapBiomas_Fogo_Brazil8b <- terra::mask(MapBiomas_Fogo_Brazil8b, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8b))
              
              if(1 %in% MapBiomas_Fogo_Brazil8b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8c <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8c)
              
            } else{
              
              MapBiomas_Fogo_Brazil8c <- terra::mask(MapBiomas_Fogo_Brazil8c, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8c))
              
              if(1 %in% MapBiomas_Fogo_Brazil8c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8d <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8d)
              
            } else{
              
              MapBiomas_Fogo_Brazil8d <- terra::mask(MapBiomas_Fogo_Brazil8d, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8d))
              
              if(1 %in% MapBiomas_Fogo_Brazil8d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8e <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8e)
              
            } else{
              
              MapBiomas_Fogo_Brazil8e <- terra::mask(MapBiomas_Fogo_Brazil8e, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8e))
              
              if(1 %in% MapBiomas_Fogo_Brazil8e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil8)
            
            MapBiomas_Fogo_Brazil8_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil8a") == T){"MapBiomas_Fogo_Brazil8a"},
              if(exists("MapBiomas_Fogo_Brazil8b") == T){"MapBiomas_Fogo_Brazil8b"},
              if(exists("MapBiomas_Fogo_Brazil8c") == T){"MapBiomas_Fogo_Brazil8c"},
              if(exists("MapBiomas_Fogo_Brazil8d") == T){"MapBiomas_Fogo_Brazil8d"},
              if(exists("MapBiomas_Fogo_Brazil8e") == T){"MapBiomas_Fogo_Brazil8e"}
              
            )
            MapBiomas_Fogo_Brazil8_chunk_n <- 0:length(MapBiomas_Fogo_Brazil8_chunk)
            
            MapBiomas_Fogo_Brazil8 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil8_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil8 <- get(MapBiomas_Fogo_Brazil8_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil8_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil8 <- terra::union(MapBiomas_Fogo_Brazil8, get(MapBiomas_Fogo_Brazil8_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil8a") == T) {rm(MapBiomas_Fogo_Brazil8a)}
            if(exists("MapBiomas_Fogo_Brazil8b") == T) {rm(MapBiomas_Fogo_Brazil8b)}
            if(exists("MapBiomas_Fogo_Brazil8c") == T) {rm(MapBiomas_Fogo_Brazil8c)}
            if(exists("MapBiomas_Fogo_Brazil8d") == T) {rm(MapBiomas_Fogo_Brazil8d)}
            if(exists("MapBiomas_Fogo_Brazil8e") == T) {rm(MapBiomas_Fogo_Brazil8e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil8 <- terra::mask(MapBiomas_Fogo_Brazil8, sites8_grid_AOO)
            MapBiomas_Fogo_Brazil8 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil8), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites8_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil8, st_as_sf(MapBiomas_Fogo_Brazil8), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites8_intersected_mapbiomas_df <- do.call(rbind, sites8_intersected_mapbiomas)
          colnames(sites8_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil8)
          rm(MapBiomas_LandUse_Brazil8)
          
          # CRS 9
          sites9 <- sites_AOO %>% filter(UTMzone == UTM_zone[9])
          crs(sites9) <- CRS[9]
          sites9_as_sf<-st_as_sf(sites9)
          if(as.numeric(nrow(unique(sites9@coords)))==1|as.numeric(length(unique(sites9@coords[,1])))==1|as.numeric(length(unique(sites9@coords[,2])))==1){
            sites9_grid<-gBuffer(sites9, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites9_grid) <- CRS[9]
            sites9_grid_AOO<-sites9_grid
          } else{
            sites9_grid<-st_make_grid(sites9_as_sf, cellsize = .09)
            sites9_grid_AOO<-sites9_grid[sites9_as_sf]
          }
          # Converter raster para Zona UTM/WGS99
          MapBiomas_Fogo_Brazil9 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil9) <- CRS[9]
          
          MapBiomas_LandUse_Brazil9 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil9) <- CRS[9]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites9_grid_AOO)[1] == "sfc_POLYGON"){
            sites9_grid_AOO <- as_Spatial(sites9_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil9 <- terra::crop(MapBiomas_Fogo_Brazil9, extent(sites9_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil9)[4,]-extent(MapBiomas_Fogo_Brazil9)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil9)[4,]-extent(MapBiomas_Fogo_Brazil9)[3,])/6
            
            MapBiomas_Fogo_Brazil9a <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9a)
              
            } else{
              
              MapBiomas_Fogo_Brazil9a <- terra::mask(MapBiomas_Fogo_Brazil9a, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9a))
              
              if(1 %in% MapBiomas_Fogo_Brazil9a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9b <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9b)
              
            } else{
              
              MapBiomas_Fogo_Brazil9b <- terra::mask(MapBiomas_Fogo_Brazil9b, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9b))
              
              if(1 %in% MapBiomas_Fogo_Brazil9b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9c <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9c)
              
            } else{
              
              MapBiomas_Fogo_Brazil9c <- terra::mask(MapBiomas_Fogo_Brazil9c, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9c))
              
              if(1 %in% MapBiomas_Fogo_Brazil9c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9d <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9d)
              
            } else{
              
              MapBiomas_Fogo_Brazil9d <- terra::mask(MapBiomas_Fogo_Brazil9d, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9d))
              
              if(1 %in% MapBiomas_Fogo_Brazil9d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9e <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9e)
              
            } else{
              
              MapBiomas_Fogo_Brazil9e <- terra::mask(MapBiomas_Fogo_Brazil9e, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9e))
              
              if(1 %in% MapBiomas_Fogo_Brazil9e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil9)
            
            MapBiomas_Fogo_Brazil9_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil9a") == T){"MapBiomas_Fogo_Brazil9a"},
              if(exists("MapBiomas_Fogo_Brazil9b") == T){"MapBiomas_Fogo_Brazil9b"},
              if(exists("MapBiomas_Fogo_Brazil9c") == T){"MapBiomas_Fogo_Brazil9c"},
              if(exists("MapBiomas_Fogo_Brazil9d") == T){"MapBiomas_Fogo_Brazil9d"},
              if(exists("MapBiomas_Fogo_Brazil9e") == T){"MapBiomas_Fogo_Brazil9e"}
              
            )
            MapBiomas_Fogo_Brazil9_chunk_n <- 0:length(MapBiomas_Fogo_Brazil9_chunk)
            
            MapBiomas_Fogo_Brazil9 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil9_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil9 <- get(MapBiomas_Fogo_Brazil9_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil9_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil9 <- terra::union(MapBiomas_Fogo_Brazil9, get(MapBiomas_Fogo_Brazil9_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil9a") == T) {rm(MapBiomas_Fogo_Brazil9a)}
            if(exists("MapBiomas_Fogo_Brazil9b") == T) {rm(MapBiomas_Fogo_Brazil9b)}
            if(exists("MapBiomas_Fogo_Brazil9c") == T) {rm(MapBiomas_Fogo_Brazil9c)}
            if(exists("MapBiomas_Fogo_Brazil9d") == T) {rm(MapBiomas_Fogo_Brazil9d)}
            if(exists("MapBiomas_Fogo_Brazil9e") == T) {rm(MapBiomas_Fogo_Brazil9e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil9 <- terra::mask(MapBiomas_Fogo_Brazil9, sites9_grid_AOO)
            MapBiomas_Fogo_Brazil9 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil9), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites9_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil9, st_as_sf(MapBiomas_Fogo_Brazil9), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites9_intersected_mapbiomas_df <- do.call(rbind, sites9_intersected_mapbiomas)
          colnames(sites9_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil9)
          rm(MapBiomas_LandUse_Brazil9)
          
        }
        
        if(length(UTM_zone) == 10){
          
          # CRS 1
          sites1 <- sites_AOO %>% filter(UTMzone == UTM_zone[1])
          crs(sites1) <- CRS[1]
          sites1_as_sf<-st_as_sf(sites1)
          if(as.numeric(nrow(unique(sites1@coords)))==1|as.numeric(length(unique(sites1@coords[,1])))==1|as.numeric(length(unique(sites1@coords[,2])))==1){
            sites1_grid<-gBuffer(sites1, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites1_grid) <- CRS[1]
            sites1_grid_AOO<-sites1_grid
          } else{
            sites1_grid<-st_make_grid(sites1_as_sf, cellsize = .02)
            sites1_grid_AOO<-sites1_grid[sites1_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil1 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil1) <- CRS[1]
          
          MapBiomas_LandUse_Brazil1 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil1) <- CRS[1]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites1_grid_AOO)[1] == "sfc_POLYGON"){
            sites1_grid_AOO <- as_Spatial(sites1_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil1 <- terra::crop(MapBiomas_Fogo_Brazil1, extent(sites1_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil1)[4,]-extent(MapBiomas_Fogo_Brazil1)[3,])/6
            
            MapBiomas_Fogo_Brazil1a <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1a)
              
            } else{
              
              MapBiomas_Fogo_Brazil1a <- terra::mask(MapBiomas_Fogo_Brazil1a, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1a))
              
              if(identical(names(MapBiomas_Fogo_Brazil1a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1b <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1b)
              
            } else{
              
              MapBiomas_Fogo_Brazil1b <- terra::mask(MapBiomas_Fogo_Brazil1b, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1b))
              
              if(identical(names(MapBiomas_Fogo_Brazil1b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1c <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1c)
              
            } else{
              
              MapBiomas_Fogo_Brazil1c <- terra::mask(MapBiomas_Fogo_Brazil1c, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1c))
              
              if(identical(names(MapBiomas_Fogo_Brazil1c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1d <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1d)
              
            } else{
              
              MapBiomas_Fogo_Brazil1d <- terra::mask(MapBiomas_Fogo_Brazil1d, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1d))
              
              if(identical(names(MapBiomas_Fogo_Brazil1d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil1e <- terra::crop(MapBiomas_Fogo_Brazil1,
                                                   extent(extent(sites1_grid_AOO)[1,],
                                                          extent(sites1_grid_AOO)[2,],
                                                          extent(sites1_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites1_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil1e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil1e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil1e)
              
            } else{
              
              MapBiomas_Fogo_Brazil1e <- terra::mask(MapBiomas_Fogo_Brazil1e, sites1_grid_AOO)
              MapBiomas_Fogo_Brazil1e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil1e))
              
              if(identical(names(MapBiomas_Fogo_Brazil1e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil1e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil1e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil1e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil1)
            
            MapBiomas_Fogo_Brazil1_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil1a") == T){"MapBiomas_Fogo_Brazil1a"},
              if(exists("MapBiomas_Fogo_Brazil1b") == T){"MapBiomas_Fogo_Brazil1b"},
              if(exists("MapBiomas_Fogo_Brazil1c") == T){"MapBiomas_Fogo_Brazil1c"},
              if(exists("MapBiomas_Fogo_Brazil1d") == T){"MapBiomas_Fogo_Brazil1d"},
              if(exists("MapBiomas_Fogo_Brazil1e") == T){"MapBiomas_Fogo_Brazil1e"}
              
            )
            MapBiomas_Fogo_Brazil1_chunk_n <- 0:length(MapBiomas_Fogo_Brazil1_chunk)
            
            MapBiomas_Fogo_Brazil1 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil1_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil1 <- get(MapBiomas_Fogo_Brazil1_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil1_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil1 <- terra::union(MapBiomas_Fogo_Brazil1, get(MapBiomas_Fogo_Brazil1_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil1a") == T) {rm(MapBiomas_Fogo_Brazil1a)}
            if(exists("MapBiomas_Fogo_Brazil1b") == T) {rm(MapBiomas_Fogo_Brazil1b)}
            if(exists("MapBiomas_Fogo_Brazil1c") == T) {rm(MapBiomas_Fogo_Brazil1c)}
            if(exists("MapBiomas_Fogo_Brazil1d") == T) {rm(MapBiomas_Fogo_Brazil1d)}
            if(exists("MapBiomas_Fogo_Brazil1e") == T) {rm(MapBiomas_Fogo_Brazil1e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil1 <- terra::mask(MapBiomas_Fogo_Brazil1, sites1_grid_AOO)
            MapBiomas_Fogo_Brazil1 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil1), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites1_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil1, st_as_sf(MapBiomas_Fogo_Brazil1), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites1_intersected_mapbiomas_df <- do.call(rbind, sites1_intersected_mapbiomas)
          colnames(sites1_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil1)
          rm(MapBiomas_LandUse_Brazil1)
          
          # CRS 2
          sites2 <- sites_AOO %>% filter(UTMzone == UTM_zone[2])
          crs(sites2) <- CRS[2]
          sites2_as_sf<-st_as_sf(sites2)
          if(as.numeric(nrow(unique(sites2@coords)))==1|as.numeric(length(unique(sites2@coords[,1])))==1|as.numeric(length(unique(sites2@coords[,2])))==1){
            sites2_grid<-gBuffer(sites2, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites2_grid) <- CRS[2]
            sites2_grid_AOO<-sites2_grid
          } else{
            sites2_grid<-st_make_grid(sites2_as_sf, cellsize = .02)
            sites2_grid_AOO<-sites2_grid[sites2_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil2 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil2) <- CRS[2]
          
          MapBiomas_LandUse_Brazil2 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil2) <- CRS[2]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites2_grid_AOO)[1] == "sfc_POLYGON"){
            sites2_grid_AOO <- as_Spatial(sites2_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil2 <- terra::crop(MapBiomas_Fogo_Brazil2, extent(sites2_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil2)[4,]-extent(MapBiomas_Fogo_Brazil2)[3,])/6
            
            MapBiomas_Fogo_Brazil2a <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2a)
              
            } else{
              
              MapBiomas_Fogo_Brazil2a <- terra::mask(MapBiomas_Fogo_Brazil2a, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2a))
              
              if(identical(names(MapBiomas_Fogo_Brazil2a), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2a)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2a)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2b <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2b)
              
            } else{
              
              MapBiomas_Fogo_Brazil2b <- terra::mask(MapBiomas_Fogo_Brazil2b, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2b))
              
              if(identical(names(MapBiomas_Fogo_Brazil2b), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2b)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2b)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2c <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2c)
              
            } else{
              
              MapBiomas_Fogo_Brazil2c <- terra::mask(MapBiomas_Fogo_Brazil2c, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2c))
              
              if(identical(names(MapBiomas_Fogo_Brazil2c), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2c)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2c)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2d <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2d)
              
            } else{
              
              MapBiomas_Fogo_Brazil2d <- terra::mask(MapBiomas_Fogo_Brazil2d, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2d))
              
              if(identical(names(MapBiomas_Fogo_Brazil2d), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2d)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2d)
                  
                }
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil2e <- terra::crop(MapBiomas_Fogo_Brazil2,
                                                   extent(extent(sites2_grid_AOO)[1,],
                                                          extent(sites2_grid_AOO)[2,],
                                                          extent(sites2_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites2_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil2e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil2e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil2e)
              
            } else{
              
              MapBiomas_Fogo_Brazil2e <- terra::mask(MapBiomas_Fogo_Brazil2e, sites2_grid_AOO)
              MapBiomas_Fogo_Brazil2e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil2e))
              
              if(identical(names(MapBiomas_Fogo_Brazil2e), character(0))){
                
                rm(MapBiomas_Fogo_Brazil2e)
                
              } else{
                
                if(1 %in% MapBiomas_Fogo_Brazil2e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                  
                } else{
                  
                  rm(MapBiomas_Fogo_Brazil2e)
                  
                }
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil2)
            
            MapBiomas_Fogo_Brazil2_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil2a") == T){"MapBiomas_Fogo_Brazil2a"},
              if(exists("MapBiomas_Fogo_Brazil2b") == T){"MapBiomas_Fogo_Brazil2b"},
              if(exists("MapBiomas_Fogo_Brazil2c") == T){"MapBiomas_Fogo_Brazil2c"},
              if(exists("MapBiomas_Fogo_Brazil2d") == T){"MapBiomas_Fogo_Brazil2d"},
              if(exists("MapBiomas_Fogo_Brazil2e") == T){"MapBiomas_Fogo_Brazil2e"}
              
            )
            MapBiomas_Fogo_Brazil2_chunk_n <- 0:length(MapBiomas_Fogo_Brazil2_chunk)
            
            MapBiomas_Fogo_Brazil2 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil2_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil2 <- get(MapBiomas_Fogo_Brazil2_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil2_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil2 <- terra::union(MapBiomas_Fogo_Brazil2, get(MapBiomas_Fogo_Brazil2_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil2a") == T) {rm(MapBiomas_Fogo_Brazil2a)}
            if(exists("MapBiomas_Fogo_Brazil2b") == T) {rm(MapBiomas_Fogo_Brazil2b)}
            if(exists("MapBiomas_Fogo_Brazil2c") == T) {rm(MapBiomas_Fogo_Brazil2c)}
            if(exists("MapBiomas_Fogo_Brazil2d") == T) {rm(MapBiomas_Fogo_Brazil2d)}
            if(exists("MapBiomas_Fogo_Brazil2e") == T) {rm(MapBiomas_Fogo_Brazil2e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil2 <- terra::mask(MapBiomas_Fogo_Brazil2, sites2_grid_AOO)
            MapBiomas_Fogo_Brazil2 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil2), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites2_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil2, st_as_sf(MapBiomas_Fogo_Brazil2), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites2_intersected_mapbiomas_df <- do.call(rbind, sites2_intersected_mapbiomas)
          colnames(sites2_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil2)
          rm(MapBiomas_LandUse_Brazil2)
          
          # CRS 3
          sites3 <- sites_AOO %>% filter(UTMzone == UTM_zone[3])
          crs(sites3) <- CRS[3]
          sites3_as_sf<-st_as_sf(sites3)
          if(as.numeric(nrow(unique(sites3@coords)))==1|as.numeric(length(unique(sites3@coords[,1])))==1|as.numeric(length(unique(sites3@coords[,2])))==1){
            sites3_grid<-gBuffer(sites3, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites3_grid) <- CRS[3]
            sites3_grid_AOO<-sites3_grid
          } else{
            sites3_grid<-st_make_grid(sites3_as_sf, cellsize = .03)
            sites3_grid_AOO<-sites3_grid[sites3_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil3 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil3) <- CRS[3]
          
          MapBiomas_LandUse_Brazil3 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil3) <- CRS[3]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites3_grid_AOO)[1] == "sfc_POLYGON"){
            sites3_grid_AOO <- as_Spatial(sites3_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil3 <- terra::crop(MapBiomas_Fogo_Brazil3, extent(sites3_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil3)[4,]-extent(MapBiomas_Fogo_Brazil3)[3,])/6
            
            MapBiomas_Fogo_Brazil3a <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3a)
              
            } else{
              
              MapBiomas_Fogo_Brazil3a <- terra::mask(MapBiomas_Fogo_Brazil3a, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3a))
              
              if(1 %in% MapBiomas_Fogo_Brazil3a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3b <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3b)
              
            } else{
              
              MapBiomas_Fogo_Brazil3b <- terra::mask(MapBiomas_Fogo_Brazil3b, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3b))
              
              if(1 %in% MapBiomas_Fogo_Brazil3b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3c <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3c)
              
            } else{
              
              MapBiomas_Fogo_Brazil3c <- terra::mask(MapBiomas_Fogo_Brazil3c, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3c))
              
              if(1 %in% MapBiomas_Fogo_Brazil3c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3d <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3d)
              
            } else{
              
              MapBiomas_Fogo_Brazil3d <- terra::mask(MapBiomas_Fogo_Brazil3d, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3d))
              
              if(1 %in% MapBiomas_Fogo_Brazil3d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil3e <- terra::crop(MapBiomas_Fogo_Brazil3,
                                                   extent(extent(sites3_grid_AOO)[1,],
                                                          extent(sites3_grid_AOO)[2,],
                                                          extent(sites3_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites3_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil3e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil3e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil3e)
              
            } else{
              
              MapBiomas_Fogo_Brazil3e <- terra::mask(MapBiomas_Fogo_Brazil3e, sites3_grid_AOO)
              MapBiomas_Fogo_Brazil3e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil3e))
              
              if(1 %in% MapBiomas_Fogo_Brazil3e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil3e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil3)
            
            MapBiomas_Fogo_Brazil3_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil3a") == T){"MapBiomas_Fogo_Brazil3a"},
              if(exists("MapBiomas_Fogo_Brazil3b") == T){"MapBiomas_Fogo_Brazil3b"},
              if(exists("MapBiomas_Fogo_Brazil3c") == T){"MapBiomas_Fogo_Brazil3c"},
              if(exists("MapBiomas_Fogo_Brazil3d") == T){"MapBiomas_Fogo_Brazil3d"},
              if(exists("MapBiomas_Fogo_Brazil3e") == T){"MapBiomas_Fogo_Brazil3e"}
              
            )
            MapBiomas_Fogo_Brazil3_chunk_n <- 0:length(MapBiomas_Fogo_Brazil3_chunk)
            
            MapBiomas_Fogo_Brazil3 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil3_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil3 <- get(MapBiomas_Fogo_Brazil3_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil3_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil3 <- terra::union(MapBiomas_Fogo_Brazil3, get(MapBiomas_Fogo_Brazil3_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil3a") == T) {rm(MapBiomas_Fogo_Brazil3a)}
            if(exists("MapBiomas_Fogo_Brazil3b") == T) {rm(MapBiomas_Fogo_Brazil3b)}
            if(exists("MapBiomas_Fogo_Brazil3c") == T) {rm(MapBiomas_Fogo_Brazil3c)}
            if(exists("MapBiomas_Fogo_Brazil3d") == T) {rm(MapBiomas_Fogo_Brazil3d)}
            if(exists("MapBiomas_Fogo_Brazil3e") == T) {rm(MapBiomas_Fogo_Brazil3e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil3 <- terra::mask(MapBiomas_Fogo_Brazil3, sites3_grid_AOO)
            MapBiomas_Fogo_Brazil3 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil3), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites3_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil3, st_as_sf(MapBiomas_Fogo_Brazil3), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites3_intersected_mapbiomas_df <- do.call(rbind, sites3_intersected_mapbiomas)
          colnames(sites3_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil3)
          rm(MapBiomas_LandUse_Brazil3)
          
          # CRS 4
          sites4 <- sites_AOO %>% filter(UTMzone == UTM_zone[4])
          crs(sites4) <- CRS[4]
          sites4_as_sf<-st_as_sf(sites4)
          if(as.numeric(nrow(unique(sites4@coords)))==1|as.numeric(length(unique(sites4@coords[,1])))==1|as.numeric(length(unique(sites4@coords[,2])))==1){
            sites4_grid<-gBuffer(sites4, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites4_grid) <- CRS[4]
            sites4_grid_AOO<-sites4_grid
          } else{
            sites4_grid<-st_make_grid(sites4_as_sf, cellsize = .04)
            sites4_grid_AOO<-sites4_grid[sites4_as_sf]
          }
          # Converter raster para Zona UTM/WGS84
          MapBiomas_Fogo_Brazil4 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil4) <- CRS[4]
          
          MapBiomas_LandUse_Brazil4 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil4) <- CRS[4]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites4_grid_AOO)[1] == "sfc_POLYGON"){
            sites4_grid_AOO <- as_Spatial(sites4_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil4 <- terra::crop(MapBiomas_Fogo_Brazil4, extent(sites4_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil4)[4,]-extent(MapBiomas_Fogo_Brazil4)[3,])/6
            
            MapBiomas_Fogo_Brazil4a <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4a)
              
            } else{
              
              MapBiomas_Fogo_Brazil4a <- terra::mask(MapBiomas_Fogo_Brazil4a, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4a))
              
              if(1 %in% MapBiomas_Fogo_Brazil4a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4b <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4b)
              
            } else{
              
              MapBiomas_Fogo_Brazil4b <- terra::mask(MapBiomas_Fogo_Brazil4b, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4b))
              
              if(1 %in% MapBiomas_Fogo_Brazil4b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4c <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4c)
              
            } else{
              
              MapBiomas_Fogo_Brazil4c <- terra::mask(MapBiomas_Fogo_Brazil4c, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4c))
              
              if(1 %in% MapBiomas_Fogo_Brazil4c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4d <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4d)
              
            } else{
              
              MapBiomas_Fogo_Brazil4d <- terra::mask(MapBiomas_Fogo_Brazil4d, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4d))
              
              if(1 %in% MapBiomas_Fogo_Brazil4d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil4e <- terra::crop(MapBiomas_Fogo_Brazil4,
                                                   extent(extent(sites4_grid_AOO)[1,],
                                                          extent(sites4_grid_AOO)[2,],
                                                          extent(sites4_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites4_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil4e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil4e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil4e)
              
            } else{
              
              MapBiomas_Fogo_Brazil4e <- terra::mask(MapBiomas_Fogo_Brazil4e, sites4_grid_AOO)
              MapBiomas_Fogo_Brazil4e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil4e))
              
              if(1 %in% MapBiomas_Fogo_Brazil4e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil4e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil4)
            
            MapBiomas_Fogo_Brazil4_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil4a") == T){"MapBiomas_Fogo_Brazil4a"},
              if(exists("MapBiomas_Fogo_Brazil4b") == T){"MapBiomas_Fogo_Brazil4b"},
              if(exists("MapBiomas_Fogo_Brazil4c") == T){"MapBiomas_Fogo_Brazil4c"},
              if(exists("MapBiomas_Fogo_Brazil4d") == T){"MapBiomas_Fogo_Brazil4d"},
              if(exists("MapBiomas_Fogo_Brazil4e") == T){"MapBiomas_Fogo_Brazil4e"}
              
            )
            MapBiomas_Fogo_Brazil4_chunk_n <- 0:length(MapBiomas_Fogo_Brazil4_chunk)
            
            MapBiomas_Fogo_Brazil4 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil4_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil4 <- get(MapBiomas_Fogo_Brazil4_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil4_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil4 <- terra::union(MapBiomas_Fogo_Brazil4, get(MapBiomas_Fogo_Brazil4_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil4a") == T) {rm(MapBiomas_Fogo_Brazil4a)}
            if(exists("MapBiomas_Fogo_Brazil4b") == T) {rm(MapBiomas_Fogo_Brazil4b)}
            if(exists("MapBiomas_Fogo_Brazil4c") == T) {rm(MapBiomas_Fogo_Brazil4c)}
            if(exists("MapBiomas_Fogo_Brazil4d") == T) {rm(MapBiomas_Fogo_Brazil4d)}
            if(exists("MapBiomas_Fogo_Brazil4e") == T) {rm(MapBiomas_Fogo_Brazil4e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil4 <- terra::mask(MapBiomas_Fogo_Brazil4, sites4_grid_AOO)
            MapBiomas_Fogo_Brazil4 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil4), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites4_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil4, st_as_sf(MapBiomas_Fogo_Brazil4), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites4_intersected_mapbiomas_df <- do.call(rbind, sites4_intersected_mapbiomas)
          colnames(sites4_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil4)
          rm(MapBiomas_LandUse_Brazil4)
          
          # CRS 5
          sites5 <- sites_AOO %>% filter(UTMzone == UTM_zone[5])
          crs(sites5) <- CRS[5]
          sites5_as_sf<-st_as_sf(sites5)
          if(as.numeric(nrow(unique(sites5@coords)))==1|as.numeric(length(unique(sites5@coords[,1])))==1|as.numeric(length(unique(sites5@coords[,2])))==1){
            sites5_grid<-gBuffer(sites5, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites5_grid) <- CRS[5]
            sites5_grid_AOO<-sites5_grid
          } else{
            sites5_grid<-st_make_grid(sites5_as_sf, cellsize = .05)
            sites5_grid_AOO<-sites5_grid[sites5_as_sf]
          }
          # Converter raster para Zona UTM/WGS85
          MapBiomas_Fogo_Brazil5 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil5) <- CRS[5]
          
          MapBiomas_LandUse_Brazil5 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil5) <- CRS[5]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites5_grid_AOO)[1] == "sfc_POLYGON"){
            sites5_grid_AOO <- as_Spatial(sites5_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil5 <- terra::crop(MapBiomas_Fogo_Brazil5, extent(sites5_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil5)[4,]-extent(MapBiomas_Fogo_Brazil5)[3,])/6
            
            MapBiomas_Fogo_Brazil5a <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5a)
              
            } else{
              
              MapBiomas_Fogo_Brazil5a <- terra::mask(MapBiomas_Fogo_Brazil5a, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5a))
              
              if(1 %in% MapBiomas_Fogo_Brazil5a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5b <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5b)
              
            } else{
              
              MapBiomas_Fogo_Brazil5b <- terra::mask(MapBiomas_Fogo_Brazil5b, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5b))
              
              if(1 %in% MapBiomas_Fogo_Brazil5b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5c <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5c)
              
            } else{
              
              MapBiomas_Fogo_Brazil5c <- terra::mask(MapBiomas_Fogo_Brazil5c, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5c))
              
              if(1 %in% MapBiomas_Fogo_Brazil5c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5d <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5d)
              
            } else{
              
              MapBiomas_Fogo_Brazil5d <- terra::mask(MapBiomas_Fogo_Brazil5d, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5d))
              
              if(1 %in% MapBiomas_Fogo_Brazil5d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil5e <- terra::crop(MapBiomas_Fogo_Brazil5,
                                                   extent(extent(sites5_grid_AOO)[1,],
                                                          extent(sites5_grid_AOO)[2,],
                                                          extent(sites5_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites5_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil5e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil5e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil5e)
              
            } else{
              
              MapBiomas_Fogo_Brazil5e <- terra::mask(MapBiomas_Fogo_Brazil5e, sites5_grid_AOO)
              MapBiomas_Fogo_Brazil5e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil5e))
              
              if(1 %in% MapBiomas_Fogo_Brazil5e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil5e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil5)
            
            MapBiomas_Fogo_Brazil5_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil5a") == T){"MapBiomas_Fogo_Brazil5a"},
              if(exists("MapBiomas_Fogo_Brazil5b") == T){"MapBiomas_Fogo_Brazil5b"},
              if(exists("MapBiomas_Fogo_Brazil5c") == T){"MapBiomas_Fogo_Brazil5c"},
              if(exists("MapBiomas_Fogo_Brazil5d") == T){"MapBiomas_Fogo_Brazil5d"},
              if(exists("MapBiomas_Fogo_Brazil5e") == T){"MapBiomas_Fogo_Brazil5e"}
              
            )
            MapBiomas_Fogo_Brazil5_chunk_n <- 0:length(MapBiomas_Fogo_Brazil5_chunk)
            
            MapBiomas_Fogo_Brazil5 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil5_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil5 <- get(MapBiomas_Fogo_Brazil5_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil5_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil5 <- terra::union(MapBiomas_Fogo_Brazil5, get(MapBiomas_Fogo_Brazil5_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil5a") == T) {rm(MapBiomas_Fogo_Brazil5a)}
            if(exists("MapBiomas_Fogo_Brazil5b") == T) {rm(MapBiomas_Fogo_Brazil5b)}
            if(exists("MapBiomas_Fogo_Brazil5c") == T) {rm(MapBiomas_Fogo_Brazil5c)}
            if(exists("MapBiomas_Fogo_Brazil5d") == T) {rm(MapBiomas_Fogo_Brazil5d)}
            if(exists("MapBiomas_Fogo_Brazil5e") == T) {rm(MapBiomas_Fogo_Brazil5e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil5 <- terra::mask(MapBiomas_Fogo_Brazil5, sites5_grid_AOO)
            MapBiomas_Fogo_Brazil5 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil5), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites5_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil5, st_as_sf(MapBiomas_Fogo_Brazil5), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites5_intersected_mapbiomas_df <- do.call(rbind, sites5_intersected_mapbiomas)
          colnames(sites5_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil5)
          rm(MapBiomas_LandUse_Brazil5)
          
          # CRS 6
          sites6 <- sites_AOO %>% filter(UTMzone == UTM_zone[6])
          crs(sites6) <- CRS[6]
          sites6_as_sf<-st_as_sf(sites6)
          if(as.numeric(nrow(unique(sites6@coords)))==1|as.numeric(length(unique(sites6@coords[,1])))==1|as.numeric(length(unique(sites6@coords[,2])))==1){
            sites6_grid<-gBuffer(sites6, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites6_grid) <- CRS[6]
            sites6_grid_AOO<-sites6_grid
          } else{
            sites6_grid<-st_make_grid(sites6_as_sf, cellsize = .06)
            sites6_grid_AOO<-sites6_grid[sites6_as_sf]
          }
          # Converter raster para Zona UTM/WGS86
          MapBiomas_Fogo_Brazil6 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil6) <- CRS[6]
          
          MapBiomas_LandUse_Brazil6 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil6) <- CRS[6]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites6_grid_AOO)[1] == "sfc_POLYGON"){
            sites6_grid_AOO <- as_Spatial(sites6_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil6 <- terra::crop(MapBiomas_Fogo_Brazil6, extent(sites6_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil6)[4,]-extent(MapBiomas_Fogo_Brazil6)[3,])/6
            
            MapBiomas_Fogo_Brazil6a <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6a)
              
            } else{
              
              MapBiomas_Fogo_Brazil6a <- terra::mask(MapBiomas_Fogo_Brazil6a, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6a))
              
              if(1 %in% MapBiomas_Fogo_Brazil6a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6b <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6b)
              
            } else{
              
              MapBiomas_Fogo_Brazil6b <- terra::mask(MapBiomas_Fogo_Brazil6b, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6b))
              
              if(1 %in% MapBiomas_Fogo_Brazil6b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6c <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6c)
              
            } else{
              
              MapBiomas_Fogo_Brazil6c <- terra::mask(MapBiomas_Fogo_Brazil6c, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6c))
              
              if(1 %in% MapBiomas_Fogo_Brazil6c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6d <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6d)
              
            } else{
              
              MapBiomas_Fogo_Brazil6d <- terra::mask(MapBiomas_Fogo_Brazil6d, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6d))
              
              if(1 %in% MapBiomas_Fogo_Brazil6d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil6e <- terra::crop(MapBiomas_Fogo_Brazil6,
                                                   extent(extent(sites6_grid_AOO)[1,],
                                                          extent(sites6_grid_AOO)[2,],
                                                          extent(sites6_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites6_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil6e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil6e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil6e)
              
            } else{
              
              MapBiomas_Fogo_Brazil6e <- terra::mask(MapBiomas_Fogo_Brazil6e, sites6_grid_AOO)
              MapBiomas_Fogo_Brazil6e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil6e))
              
              if(1 %in% MapBiomas_Fogo_Brazil6e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil6e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil6)
            
            MapBiomas_Fogo_Brazil6_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil6a") == T){"MapBiomas_Fogo_Brazil6a"},
              if(exists("MapBiomas_Fogo_Brazil6b") == T){"MapBiomas_Fogo_Brazil6b"},
              if(exists("MapBiomas_Fogo_Brazil6c") == T){"MapBiomas_Fogo_Brazil6c"},
              if(exists("MapBiomas_Fogo_Brazil6d") == T){"MapBiomas_Fogo_Brazil6d"},
              if(exists("MapBiomas_Fogo_Brazil6e") == T){"MapBiomas_Fogo_Brazil6e"}
              
            )
            MapBiomas_Fogo_Brazil6_chunk_n <- 0:length(MapBiomas_Fogo_Brazil6_chunk)
            
            MapBiomas_Fogo_Brazil6 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil6_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil6 <- get(MapBiomas_Fogo_Brazil6_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil6_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil6 <- terra::union(MapBiomas_Fogo_Brazil6, get(MapBiomas_Fogo_Brazil6_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil6a") == T) {rm(MapBiomas_Fogo_Brazil6a)}
            if(exists("MapBiomas_Fogo_Brazil6b") == T) {rm(MapBiomas_Fogo_Brazil6b)}
            if(exists("MapBiomas_Fogo_Brazil6c") == T) {rm(MapBiomas_Fogo_Brazil6c)}
            if(exists("MapBiomas_Fogo_Brazil6d") == T) {rm(MapBiomas_Fogo_Brazil6d)}
            if(exists("MapBiomas_Fogo_Brazil6e") == T) {rm(MapBiomas_Fogo_Brazil6e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil6 <- terra::mask(MapBiomas_Fogo_Brazil6, sites6_grid_AOO)
            MapBiomas_Fogo_Brazil6 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil6), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites6_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil6, st_as_sf(MapBiomas_Fogo_Brazil6), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites6_intersected_mapbiomas_df <- do.call(rbind, sites6_intersected_mapbiomas)
          colnames(sites6_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil6)
          rm(MapBiomas_LandUse_Brazil6)
          
          # CRS 7
          sites7 <- sites_AOO %>% filter(UTMzone == UTM_zone[7])
          crs(sites7) <- CRS[7]
          sites7_as_sf<-st_as_sf(sites7)
          if(as.numeric(nrow(unique(sites7@coords)))==1|as.numeric(length(unique(sites7@coords[,1])))==1|as.numeric(length(unique(sites7@coords[,2])))==1){
            sites7_grid<-gBuffer(sites7, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites7_grid) <- CRS[7]
            sites7_grid_AOO<-sites7_grid
          } else{
            sites7_grid<-st_make_grid(sites7_as_sf, cellsize = .07)
            sites7_grid_AOO<-sites7_grid[sites7_as_sf]
          }
          # Converter raster para Zona UTM/WGS87
          MapBiomas_Fogo_Brazil7 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil7) <- CRS[7]
          
          MapBiomas_LandUse_Brazil7 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil7) <- CRS[7]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites7_grid_AOO)[1] == "sfc_POLYGON"){
            sites7_grid_AOO <- as_Spatial(sites7_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil7 <- terra::crop(MapBiomas_Fogo_Brazil7, extent(sites7_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil7)[4,]-extent(MapBiomas_Fogo_Brazil7)[3,])/6
            
            MapBiomas_Fogo_Brazil7a <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7a)
              
            } else{
              
              MapBiomas_Fogo_Brazil7a <- terra::mask(MapBiomas_Fogo_Brazil7a, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7a))
              
              if(1 %in% MapBiomas_Fogo_Brazil7a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7b <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7b)
              
            } else{
              
              MapBiomas_Fogo_Brazil7b <- terra::mask(MapBiomas_Fogo_Brazil7b, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7b))
              
              if(1 %in% MapBiomas_Fogo_Brazil7b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7c <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7c)
              
            } else{
              
              MapBiomas_Fogo_Brazil7c <- terra::mask(MapBiomas_Fogo_Brazil7c, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7c))
              
              if(1 %in% MapBiomas_Fogo_Brazil7c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7d <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7d)
              
            } else{
              
              MapBiomas_Fogo_Brazil7d <- terra::mask(MapBiomas_Fogo_Brazil7d, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7d))
              
              if(1 %in% MapBiomas_Fogo_Brazil7d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil7e <- terra::crop(MapBiomas_Fogo_Brazil7,
                                                   extent(extent(sites7_grid_AOO)[1,],
                                                          extent(sites7_grid_AOO)[2,],
                                                          extent(sites7_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites7_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil7e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil7e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil7e)
              
            } else{
              
              MapBiomas_Fogo_Brazil7e <- terra::mask(MapBiomas_Fogo_Brazil7e, sites7_grid_AOO)
              MapBiomas_Fogo_Brazil7e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil7e))
              
              if(1 %in% MapBiomas_Fogo_Brazil7e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil7e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil7)
            
            MapBiomas_Fogo_Brazil7_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil7a") == T){"MapBiomas_Fogo_Brazil7a"},
              if(exists("MapBiomas_Fogo_Brazil7b") == T){"MapBiomas_Fogo_Brazil7b"},
              if(exists("MapBiomas_Fogo_Brazil7c") == T){"MapBiomas_Fogo_Brazil7c"},
              if(exists("MapBiomas_Fogo_Brazil7d") == T){"MapBiomas_Fogo_Brazil7d"},
              if(exists("MapBiomas_Fogo_Brazil7e") == T){"MapBiomas_Fogo_Brazil7e"}
              
            )
            MapBiomas_Fogo_Brazil7_chunk_n <- 0:length(MapBiomas_Fogo_Brazil7_chunk)
            
            MapBiomas_Fogo_Brazil7 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil7_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil7 <- get(MapBiomas_Fogo_Brazil7_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil7_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil7 <- terra::union(MapBiomas_Fogo_Brazil7, get(MapBiomas_Fogo_Brazil7_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil7a") == T) {rm(MapBiomas_Fogo_Brazil7a)}
            if(exists("MapBiomas_Fogo_Brazil7b") == T) {rm(MapBiomas_Fogo_Brazil7b)}
            if(exists("MapBiomas_Fogo_Brazil7c") == T) {rm(MapBiomas_Fogo_Brazil7c)}
            if(exists("MapBiomas_Fogo_Brazil7d") == T) {rm(MapBiomas_Fogo_Brazil7d)}
            if(exists("MapBiomas_Fogo_Brazil7e") == T) {rm(MapBiomas_Fogo_Brazil7e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil7 <- terra::mask(MapBiomas_Fogo_Brazil7, sites7_grid_AOO)
            MapBiomas_Fogo_Brazil7 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil7), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites7_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil7, st_as_sf(MapBiomas_Fogo_Brazil7), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites7_intersected_mapbiomas_df <- do.call(rbind, sites7_intersected_mapbiomas)
          colnames(sites7_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil7)
          rm(MapBiomas_LandUse_Brazil7)
          
          # CRS 8
          sites8 <- sites_AOO %>% filter(UTMzone == UTM_zone[8])
          crs(sites8) <- CRS[8]
          sites8_as_sf<-st_as_sf(sites8)
          if(as.numeric(nrow(unique(sites8@coords)))==1|as.numeric(length(unique(sites8@coords[,1])))==1|as.numeric(length(unique(sites8@coords[,2])))==1){
            sites8_grid<-gBuffer(sites8, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites8_grid) <- CRS[8]
            sites8_grid_AOO<-sites8_grid
          } else{
            sites8_grid<-st_make_grid(sites8_as_sf, cellsize = .08)
            sites8_grid_AOO<-sites8_grid[sites8_as_sf]
          }
          # Converter raster para Zona UTM/WGS88
          MapBiomas_Fogo_Brazil8 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil8) <- CRS[8]
          
          MapBiomas_LandUse_Brazil8 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil8) <- CRS[8]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites8_grid_AOO)[1] == "sfc_POLYGON"){
            sites8_grid_AOO <- as_Spatial(sites8_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil8 <- terra::crop(MapBiomas_Fogo_Brazil8, extent(sites8_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil8)[4,]-extent(MapBiomas_Fogo_Brazil8)[3,])/6
            
            MapBiomas_Fogo_Brazil8a <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8a)
              
            } else{
              
              MapBiomas_Fogo_Brazil8a <- terra::mask(MapBiomas_Fogo_Brazil8a, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8a))
              
              if(1 %in% MapBiomas_Fogo_Brazil8a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8b <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8b)
              
            } else{
              
              MapBiomas_Fogo_Brazil8b <- terra::mask(MapBiomas_Fogo_Brazil8b, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8b))
              
              if(1 %in% MapBiomas_Fogo_Brazil8b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8c <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8c)
              
            } else{
              
              MapBiomas_Fogo_Brazil8c <- terra::mask(MapBiomas_Fogo_Brazil8c, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8c))
              
              if(1 %in% MapBiomas_Fogo_Brazil8c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8d <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8d)
              
            } else{
              
              MapBiomas_Fogo_Brazil8d <- terra::mask(MapBiomas_Fogo_Brazil8d, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8d))
              
              if(1 %in% MapBiomas_Fogo_Brazil8d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil8e <- terra::crop(MapBiomas_Fogo_Brazil8,
                                                   extent(extent(sites8_grid_AOO)[1,],
                                                          extent(sites8_grid_AOO)[2,],
                                                          extent(sites8_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites8_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil8e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil8e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil8e)
              
            } else{
              
              MapBiomas_Fogo_Brazil8e <- terra::mask(MapBiomas_Fogo_Brazil8e, sites8_grid_AOO)
              MapBiomas_Fogo_Brazil8e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil8e))
              
              if(1 %in% MapBiomas_Fogo_Brazil8e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil8e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil8)
            
            MapBiomas_Fogo_Brazil8_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil8a") == T){"MapBiomas_Fogo_Brazil8a"},
              if(exists("MapBiomas_Fogo_Brazil8b") == T){"MapBiomas_Fogo_Brazil8b"},
              if(exists("MapBiomas_Fogo_Brazil8c") == T){"MapBiomas_Fogo_Brazil8c"},
              if(exists("MapBiomas_Fogo_Brazil8d") == T){"MapBiomas_Fogo_Brazil8d"},
              if(exists("MapBiomas_Fogo_Brazil8e") == T){"MapBiomas_Fogo_Brazil8e"}
              
            )
            MapBiomas_Fogo_Brazil8_chunk_n <- 0:length(MapBiomas_Fogo_Brazil8_chunk)
            
            MapBiomas_Fogo_Brazil8 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil8_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil8 <- get(MapBiomas_Fogo_Brazil8_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil8_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil8 <- terra::union(MapBiomas_Fogo_Brazil8, get(MapBiomas_Fogo_Brazil8_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil8a") == T) {rm(MapBiomas_Fogo_Brazil8a)}
            if(exists("MapBiomas_Fogo_Brazil8b") == T) {rm(MapBiomas_Fogo_Brazil8b)}
            if(exists("MapBiomas_Fogo_Brazil8c") == T) {rm(MapBiomas_Fogo_Brazil8c)}
            if(exists("MapBiomas_Fogo_Brazil8d") == T) {rm(MapBiomas_Fogo_Brazil8d)}
            if(exists("MapBiomas_Fogo_Brazil8e") == T) {rm(MapBiomas_Fogo_Brazil8e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil8 <- terra::mask(MapBiomas_Fogo_Brazil8, sites8_grid_AOO)
            MapBiomas_Fogo_Brazil8 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil8), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites8_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil8, st_as_sf(MapBiomas_Fogo_Brazil8), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites8_intersected_mapbiomas_df <- do.call(rbind, sites8_intersected_mapbiomas)
          colnames(sites8_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil8)
          rm(MapBiomas_LandUse_Brazil8)
          
          # CRS 9
          sites9 <- sites_AOO %>% filter(UTMzone == UTM_zone[9])
          crs(sites9) <- CRS[9]
          sites9_as_sf<-st_as_sf(sites9)
          if(as.numeric(nrow(unique(sites9@coords)))==1|as.numeric(length(unique(sites9@coords[,1])))==1|as.numeric(length(unique(sites9@coords[,2])))==1){
            sites9_grid<-gBuffer(sites9, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites9_grid) <- CRS[9]
            sites9_grid_AOO<-sites9_grid
          } else{
            sites9_grid<-st_make_grid(sites9_as_sf, cellsize = .09)
            sites9_grid_AOO<-sites9_grid[sites9_as_sf]
          }
          # Converter raster para Zona UTM/WGS99
          MapBiomas_Fogo_Brazil9 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil9) <- CRS[9]
          
          MapBiomas_LandUse_Brazil9 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil9) <- CRS[9]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites9_grid_AOO)[1] == "sfc_POLYGON"){
            sites9_grid_AOO <- as_Spatial(sites9_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil9 <- terra::crop(MapBiomas_Fogo_Brazil9, extent(sites9_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil9)[4,]-extent(MapBiomas_Fogo_Brazil9)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil9)[4,]-extent(MapBiomas_Fogo_Brazil9)[3,])/6
            
            MapBiomas_Fogo_Brazil9a <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9a)
              
            } else{
              
              MapBiomas_Fogo_Brazil9a <- terra::mask(MapBiomas_Fogo_Brazil9a, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9a))
              
              if(1 %in% MapBiomas_Fogo_Brazil9a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9b <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9b)
              
            } else{
              
              MapBiomas_Fogo_Brazil9b <- terra::mask(MapBiomas_Fogo_Brazil9b, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9b))
              
              if(1 %in% MapBiomas_Fogo_Brazil9b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9c <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9c)
              
            } else{
              
              MapBiomas_Fogo_Brazil9c <- terra::mask(MapBiomas_Fogo_Brazil9c, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9c))
              
              if(1 %in% MapBiomas_Fogo_Brazil9c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9d <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9d)
              
            } else{
              
              MapBiomas_Fogo_Brazil9d <- terra::mask(MapBiomas_Fogo_Brazil9d, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9d))
              
              if(1 %in% MapBiomas_Fogo_Brazil9d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil9e <- terra::crop(MapBiomas_Fogo_Brazil9,
                                                   extent(extent(sites9_grid_AOO)[1,],
                                                          extent(sites9_grid_AOO)[2,],
                                                          extent(sites9_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                          extent(sites9_grid_AOO)[4,]
                                                   )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil9e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil9e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil9e)
              
            } else{
              
              MapBiomas_Fogo_Brazil9e <- terra::mask(MapBiomas_Fogo_Brazil9e, sites9_grid_AOO)
              MapBiomas_Fogo_Brazil9e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil9e))
              
              if(1 %in% MapBiomas_Fogo_Brazil9e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil9e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil9)
            
            MapBiomas_Fogo_Brazil9_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil9a") == T){"MapBiomas_Fogo_Brazil9a"},
              if(exists("MapBiomas_Fogo_Brazil9b") == T){"MapBiomas_Fogo_Brazil9b"},
              if(exists("MapBiomas_Fogo_Brazil9c") == T){"MapBiomas_Fogo_Brazil9c"},
              if(exists("MapBiomas_Fogo_Brazil9d") == T){"MapBiomas_Fogo_Brazil9d"},
              if(exists("MapBiomas_Fogo_Brazil9e") == T){"MapBiomas_Fogo_Brazil9e"}
              
            )
            MapBiomas_Fogo_Brazil9_chunk_n <- 0:length(MapBiomas_Fogo_Brazil9_chunk)
            
            MapBiomas_Fogo_Brazil9 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil9_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil9 <- get(MapBiomas_Fogo_Brazil9_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil9_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil9 <- terra::union(MapBiomas_Fogo_Brazil9, get(MapBiomas_Fogo_Brazil9_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil9a") == T) {rm(MapBiomas_Fogo_Brazil9a)}
            if(exists("MapBiomas_Fogo_Brazil9b") == T) {rm(MapBiomas_Fogo_Brazil9b)}
            if(exists("MapBiomas_Fogo_Brazil9c") == T) {rm(MapBiomas_Fogo_Brazil9c)}
            if(exists("MapBiomas_Fogo_Brazil9d") == T) {rm(MapBiomas_Fogo_Brazil9d)}
            if(exists("MapBiomas_Fogo_Brazil9e") == T) {rm(MapBiomas_Fogo_Brazil9e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil9 <- terra::mask(MapBiomas_Fogo_Brazil9, sites9_grid_AOO)
            MapBiomas_Fogo_Brazil9 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil9), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites9_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil9, st_as_sf(MapBiomas_Fogo_Brazil9), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites9_intersected_mapbiomas_df <- do.call(rbind, sites9_intersected_mapbiomas)
          colnames(sites9_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil9)
          rm(MapBiomas_LandUse_Brazil9)
          
          # CRS 10
          sites10 <- sites_AOO %>% filter(UTMzone == UTM_zone[10])
          crs(sites10) <- CRS[10]
          sites10_as_sf<-st_as_sf(sites10)
          if(as.numeric(nrow(unique(sites10@coords)))==1|as.numeric(length(unique(sites10@coords[,1])))==1|as.numeric(length(unique(sites10@coords[,2])))==1){
            sites10_grid<-gBuffer(sites10, byid = TRUE, capStyle = "SQUARE", width = 0.01)
            crs(sites10_grid) <- CRS[10]
            sites10_grid_AOO<-sites10_grid
          } else{
            sites10_grid<-st_make_grid(sites10_as_sf, cellsize = .010)
            sites10_grid_AOO<-sites10_grid[sites10_as_sf]
          }
          # Converter raster para Zona UTM/WGS1010
          MapBiomas_Fogo_Brazil10 <- MapBiomas_Fogo_Brazil
          crs(MapBiomas_Fogo_Brazil10) <- CRS[10]
          
          MapBiomas_LandUse_Brazil10 <- MapBiomas_LandUse_Brazil
          crs(MapBiomas_LandUse_Brazil10) <- CRS[10]
          
          # Converter objeto sfcPOLYGON to SpatialPolygons
          if(class(sites10_grid_AOO)[1] == "sfc_POLYGON"){
            sites10_grid_AOO <- as_Spatial(sites10_grid_AOO)
          }
          
          MapBiomas_Fogo_Brazil10 <- terra::crop(MapBiomas_Fogo_Brazil10, extent(sites10_grid_AOO))
          
          if(extent(MapBiomas_Fogo_Brazil10)[4,]-extent(MapBiomas_Fogo_Brazil10)[3,] > 8){
            y_dividido <- (extent(MapBiomas_Fogo_Brazil10)[4,]-extent(MapBiomas_Fogo_Brazil10)[3,])/6
            
            MapBiomas_Fogo_Brazil10a <- terra::crop(MapBiomas_Fogo_Brazil10,
                                                    extent(extent(sites10_grid_AOO)[1,],
                                                           extent(sites10_grid_AOO)[2,],
                                                           extent(sites10_grid_AOO)[3,],
                                                           extent(sites10_grid_AOO)[3,]+y_dividido
                                                    )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil10a))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil10a)) == 0){
              
              rm(MapBiomas_Fogo_Brazil10a)
              
            } else{
              
              MapBiomas_Fogo_Brazil10a <- terra::mask(MapBiomas_Fogo_Brazil10a, sites10_grid_AOO)
              MapBiomas_Fogo_Brazil10a <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil10a))
              
              if(1 %in% MapBiomas_Fogo_Brazil10a$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil10a)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil10b <- terra::crop(MapBiomas_Fogo_Brazil10,
                                                    extent(extent(sites10_grid_AOO)[1,],
                                                           extent(sites10_grid_AOO)[2,],
                                                           extent(sites10_grid_AOO)[3,]+y_dividido,
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido
                                                    )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil10b))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil10b)) == 0){
              
              rm(MapBiomas_Fogo_Brazil10b)
              
            } else{
              
              MapBiomas_Fogo_Brazil10b <- terra::mask(MapBiomas_Fogo_Brazil10b, sites10_grid_AOO)
              MapBiomas_Fogo_Brazil10b <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil10b))
              
              if(1 %in% MapBiomas_Fogo_Brazil10b$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil10b)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil10c <- terra::crop(MapBiomas_Fogo_Brazil10,
                                                    extent(extent(sites10_grid_AOO)[1,],
                                                           extent(sites10_grid_AOO)[2,],
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido,
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido
                                                    )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil10c))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil10c)) == 0){
              
              rm(MapBiomas_Fogo_Brazil10c)
              
            } else{
              
              MapBiomas_Fogo_Brazil10c <- terra::mask(MapBiomas_Fogo_Brazil10c, sites10_grid_AOO)
              MapBiomas_Fogo_Brazil10c <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil10c))
              
              if(1 %in% MapBiomas_Fogo_Brazil10c$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil10c)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil10d <- terra::crop(MapBiomas_Fogo_Brazil10,
                                                    extent(extent(sites10_grid_AOO)[1,],
                                                           extent(sites10_grid_AOO)[2,],
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido,
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido
                                                    )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil10d))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil10d)) == 0){
              
              rm(MapBiomas_Fogo_Brazil10d)
              
            } else{
              
              MapBiomas_Fogo_Brazil10d <- terra::mask(MapBiomas_Fogo_Brazil10d, sites10_grid_AOO)
              MapBiomas_Fogo_Brazil10d <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil10d))
              
              if(1 %in% MapBiomas_Fogo_Brazil10d$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil10d)
                
              }
              
            }
            
            MapBiomas_Fogo_Brazil10e <- terra::crop(MapBiomas_Fogo_Brazil10,
                                                    extent(extent(sites10_grid_AOO)[1,],
                                                           extent(sites10_grid_AOO)[2,],
                                                           extent(sites10_grid_AOO)[3,]+y_dividido+y_dividido+y_dividido+y_dividido,
                                                           extent(sites10_grid_AOO)[4,]
                                                    )
            )
            
            if(all(is.na(terra::values(MapBiomas_Fogo_Brazil10e))) == T |
               length(terra::values(MapBiomas_Fogo_Brazil10e)) == 0){
              
              rm(MapBiomas_Fogo_Brazil10e)
              
            } else{
              
              MapBiomas_Fogo_Brazil10e <- terra::mask(MapBiomas_Fogo_Brazil10e, sites10_grid_AOO)
              MapBiomas_Fogo_Brazil10e <- terra::as.polygons(terra::rast(MapBiomas_Fogo_Brazil10e))
              
              if(1 %in% MapBiomas_Fogo_Brazil10e$mapbiomas_fogo.brazil.collection.10.2020_20m == T){
                
              } else{
                
                rm(MapBiomas_Fogo_Brazil10e)
                
              }
              
            }
            
            rm(MapBiomas_Fogo_Brazil10)
            
            MapBiomas_Fogo_Brazil10_chunk <- c(
              
              if(exists("MapBiomas_Fogo_Brazil10a") == T){"MapBiomas_Fogo_Brazil10a"},
              if(exists("MapBiomas_Fogo_Brazil10b") == T){"MapBiomas_Fogo_Brazil10b"},
              if(exists("MapBiomas_Fogo_Brazil10c") == T){"MapBiomas_Fogo_Brazil10c"},
              if(exists("MapBiomas_Fogo_Brazil10d") == T){"MapBiomas_Fogo_Brazil10d"},
              if(exists("MapBiomas_Fogo_Brazil10e") == T){"MapBiomas_Fogo_Brazil10e"}
              
            )
            MapBiomas_Fogo_Brazil10_chunk_n <- 0:length(MapBiomas_Fogo_Brazil10_chunk)
            
            MapBiomas_Fogo_Brazil10 <- NULL
            for(chunk in MapBiomas_Fogo_Brazil10_chunk_n){
              
              if(chunk == 0){
                
                MapBiomas_Fogo_Brazil10 <- get(MapBiomas_Fogo_Brazil10_chunk[1])
                
              } else{
                
                if(chunk < max(MapBiomas_Fogo_Brazil10_chunk_n)){
                  
                  MapBiomas_Fogo_Brazil10 <- terra::union(MapBiomas_Fogo_Brazil10, get(MapBiomas_Fogo_Brazil10_chunk[chunk+1]))
                  
                }
                
              }
              
            }
            
            if(exists("MapBiomas_Fogo_Brazil10a") == T) {rm(MapBiomas_Fogo_Brazil10a)}
            if(exists("MapBiomas_Fogo_Brazil10b") == T) {rm(MapBiomas_Fogo_Brazil10b)}
            if(exists("MapBiomas_Fogo_Brazil10c") == T) {rm(MapBiomas_Fogo_Brazil10c)}
            if(exists("MapBiomas_Fogo_Brazil10d") == T) {rm(MapBiomas_Fogo_Brazil10d)}
            if(exists("MapBiomas_Fogo_Brazil10e") == T) {rm(MapBiomas_Fogo_Brazil10e)}
            
          } else{
            
            MapBiomas_Fogo_Brazil10 <- terra::mask(MapBiomas_Fogo_Brazil10, sites10_grid_AOO)
            MapBiomas_Fogo_Brazil10 <- st_as_sf(stars::st_as_stars(MapBiomas_Fogo_Brazil10), point = FALSE, merge = TRUE, connect8 = TRUE)
            
          }
          
          # Intersectar Raster e coordenadas
          sites10_intersected_mapbiomas <- exact_extract(MapBiomas_LandUse_Brazil10, st_as_sf(MapBiomas_Fogo_Brazil10), include_cols = "mapbiomas_fogo.brazil.collection.10.2020_20m")
          sites10_intersected_mapbiomas_df <- do.call(rbind, sites10_intersected_mapbiomas)
          colnames(sites10_intersected_mapbiomas_df) <- c("MapBiomas_Fogo_2020", "AOO_total", "coverage_fraction")
          
          rm(MapBiomas_Fogo_Brazil10)
          rm(MapBiomas_LandUse_Brazil10)
          
        }
        
        # Agregação de objetos de diferentes CRSs ####
        if(length(UTM_zone) == 1){
          sites_intersected_mapbiomas_df <- sites1_intersected_mapbiomas_df
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==2){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==3){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==4){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==5){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==6){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df},
                                                  if(exists("sites6_intersected_mapbiomas_df") == T){sites6_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==7){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df},
                                                  if(exists("sites6_intersected_mapbiomas_df") == T){sites6_intersected_mapbiomas_df},
                                                  if(exists("sites7_intersected_mapbiomas_df") == T){sites7_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==8){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df},
                                                  if(exists("sites6_intersected_mapbiomas_df") == T){sites6_intersected_mapbiomas_df},
                                                  if(exists("sites7_intersected_mapbiomas_df") == T){sites7_intersected_mapbiomas_df},
                                                  if(exists("sites8_intersected_mapbiomas_df") == T){sites8_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==9){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df},
                                                  if(exists("sites6_intersected_mapbiomas_df") == T){sites6_intersected_mapbiomas_df},
                                                  if(exists("sites7_intersected_mapbiomas_df") == T){sites7_intersected_mapbiomas_df},
                                                  if(exists("sites8_intersected_mapbiomas_df") == T){sites8_intersected_mapbiomas_df},
                                                  if(exists("sites9_intersected_mapbiomas_df") == T){sites9_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        if(length(UTM_zone)==10){
          sites_intersected_mapbiomas_df <- rbind(if(exists("sites1_intersected_mapbiomas_df") == T){sites1_intersected_mapbiomas_df},
                                                  if(exists("sites2_intersected_mapbiomas_df") == T){sites2_intersected_mapbiomas_df},
                                                  if(exists("sites3_intersected_mapbiomas_df") == T){sites3_intersected_mapbiomas_df},
                                                  if(exists("sites4_intersected_mapbiomas_df") == T){sites4_intersected_mapbiomas_df},
                                                  if(exists("sites5_intersected_mapbiomas_df") == T){sites5_intersected_mapbiomas_df},
                                                  if(exists("sites6_intersected_mapbiomas_df") == T){sites6_intersected_mapbiomas_df},
                                                  if(exists("sites7_intersected_mapbiomas_df") == T){sites7_intersected_mapbiomas_df},
                                                  if(exists("sites8_intersected_mapbiomas_df") == T){sites8_intersected_mapbiomas_df},
                                                  if(exists("sites9_intersected_mapbiomas_df") == T){sites9_intersected_mapbiomas_df},
                                                  if(exists("sites10_intersected_mapbiomas_df") == T){sites10_intersected_mapbiomas_df}
          )
          sites_aggregated_area_km2 <- AOO_area_s_centr_mun
          sites_aggregated_area_ha <- AOO_area_s_centr_mun*100
        }
        
        # Convertendo feições de ameaças de números para texto ####
        sites_intersected_mapbiomas_df$AOO_total <- sub("^15$", "Pastagem", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^41$", "Outras lavouras temporárias", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^39$", "Soja", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^20$", "Cana-de-açúcar", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^36$", "Lavouras perenes", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^21$", "Mosaico de Agricultura e Pastagem", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^24$", "Infraestrutura urbana", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^30$", "Mineração", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^11$", "Campo Alagado e Área Pantanosa", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^12$", "Formação Campestre", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^13$", "Outras Formações não Florestais", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^19$", "Lavoura Temporária", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^23$", "Praia, Duna e Areal", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^25$", "Outras Áreas não Vegetadas", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^27$", "Não Observado", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^29$", "Afloramento Rochoso", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^31$", "Aquicultura", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^32$", "Apicum", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^33$", "Rio, Lago e Oceano", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^40$", "Arroz", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^46$", "Café", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^47$", "Citrus", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^48$", "Outras Lavouras Perenes", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^49$", "Restinga Arborizada", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^9$", "Floresta Plantada", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^3$", "Floresta", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^4$", "Savana", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^5$", "Mangue", sites_intersected_mapbiomas_df$AOO_total)
        sites_intersected_mapbiomas_df$AOO_total <- sub("^0$", "NA", sites_intersected_mapbiomas_df$AOO_total)
        
        # Filtragens das ameaças ####
        sites_intersected_mapbiomas_df_urbana <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Infraestrutura urbana" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_mineracao <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Mineração" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_silvicultura <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Floresta Plantada" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_outras_lavouras_temporarias <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Outras lavouras temporárias" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_soja <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Soja" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_cana <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Cana-de-açúcar" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_lavouras_perenes <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Lavouras perenes" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_pastagem <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Pastagem" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_mosaic_past_agric <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Mosaico de Agricultura e Pastagem" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_floresta <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Floresta" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_savana <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Savana" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_mangue <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Mangue" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_alagado_pantanosa <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Campo Alagado e Área Pantanosa" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_campos <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Formação Campestre" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_outras_nao_florestais <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Outras Formações não Florestais" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_lavouras_temporarias <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Lavoura Temporária" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_praia_duna_areal <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Praia, Duna e Areal" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_outras_nao_vegetadas <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Outras Áreas não Vegetadas" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_nao_observado <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Não Observado" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_afloramento_rochoso <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Afloramento Rochoso" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_aquicultura <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Aquicultura" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_apicum <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Apicum" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_rio_lago_oceano <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Rio, Lago e Oceano" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_arroz <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Arroz" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_cafe <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Café" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_citrus <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Citrus" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_outras_lavouras_perenes <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Outras Lavouras Perenes" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_restinga_arborizada <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "Restinga Arborizada" & MapBiomas_Fogo_2020 == 1)
        sites_intersected_mapbiomas_df_NA <- sites_intersected_mapbiomas_df %>% filter(AOO_total == "NA" & MapBiomas_Fogo_2020 == 1)
        
        # Cálculo da área das feições ####
        sites_aggregated_area_km2_num <- sites_aggregated_area_km2
        count_sites_intersected_mapbiomas <- sum(sites_intersected_mapbiomas_df$coverage_fraction)
        
        ## Infraestrutura urbana
        count_area_sites_intersected_mapbiomas_df_urbana <- sum(sites_intersected_mapbiomas_df_urbana$coverage_fraction)
        area_km2_urbana <- count_area_sites_intersected_mapbiomas_df_urbana * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_urbana <- area_km2_urbana*100/sites_aggregated_area_km2_num
        
        ## Mineração
        count_area_sites_intersected_mapbiomas_df_mineracao <- sum(sites_intersected_mapbiomas_df_mineracao$coverage_fraction)
        area_km2_mineracao <- count_area_sites_intersected_mapbiomas_df_mineracao * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_mineracao <- area_km2_mineracao*100/sites_aggregated_area_km2_num
        
        ## Silvicultura
        count_area_sites_intersected_mapbiomas_df_silvicultura <- sum(sites_intersected_mapbiomas_df_silvicultura$coverage_fraction)
        area_km2_silvicultura <- count_area_sites_intersected_mapbiomas_df_silvicultura * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_silvicultura <- area_km2_silvicultura*100/sites_aggregated_area_km2_num
        
        ## Outras lavouras temporárias
        count_area_sites_intersected_mapbiomas_df_outras_lavouras_temporarias <- sum(sites_intersected_mapbiomas_df_outras_lavouras_temporarias$coverage_fraction)
        area_km2_outras_lavouras_temporarias <- count_area_sites_intersected_mapbiomas_df_outras_lavouras_temporarias * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_outras_lavouras_temporarias <- area_km2_outras_lavouras_temporarias*100/sites_aggregated_area_km2_num
        
        ## Soja
        count_area_sites_intersected_mapbiomas_df_soja <- sum(sites_intersected_mapbiomas_df_soja$coverage_fraction)
        area_km2_soja <- count_area_sites_intersected_mapbiomas_df_soja * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_soja <- area_km2_soja*100/sites_aggregated_area_km2_num
        
        ## Cana-de-açúcar
        count_area_sites_intersected_mapbiomas_df_cana <- sum(sites_intersected_mapbiomas_df_cana$coverage_fraction)
        area_km2_cana <- count_area_sites_intersected_mapbiomas_df_cana * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_cana <- area_km2_cana*100/sites_aggregated_area_km2_num
        
        ## Lavouras perenes
        count_area_sites_intersected_mapbiomas_df_lavouras_perenes <- sum(sites_intersected_mapbiomas_df_lavouras_perenes$coverage_fraction)
        area_km2_lavouras_perenes <- count_area_sites_intersected_mapbiomas_df_lavouras_perenes * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_lavouras_perenes <- area_km2_lavouras_perenes*100/sites_aggregated_area_km2_num
        
        ## Pastagem
        count_area_sites_intersected_mapbiomas_df_pastagem <- sum(sites_intersected_mapbiomas_df_pastagem$coverage_fraction)
        area_km2_pastagem <- count_area_sites_intersected_mapbiomas_df_pastagem * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_pastagem <- area_km2_pastagem*100/sites_aggregated_area_km2_num
        
        ## Mosaico Pastagem e Agricultura
        count_area_sites_intersected_mapbiomas_df_mosaic_past_agric <- sum(sites_intersected_mapbiomas_df_mosaic_past_agric$coverage_fraction)
        area_km2_mosaic_past_agric <- count_area_sites_intersected_mapbiomas_df_mosaic_past_agric * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_mosaic_past_agric <- area_km2_mosaic_past_agric*100/sites_aggregated_area_km2_num
        
        ## Floresta
        count_area_sites_intersected_mapbiomas_df_floresta <- sum(sites_intersected_mapbiomas_df_floresta$coverage_fraction)
        area_km2_floresta <- count_area_sites_intersected_mapbiomas_df_floresta * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_floresta <- area_km2_floresta*100/sites_aggregated_area_km2_num
        
        ## Savana
        count_area_sites_intersected_mapbiomas_df_savana <- sum(sites_intersected_mapbiomas_df_savana$coverage_fraction)
        area_km2_savana <- count_area_sites_intersected_mapbiomas_df_savana * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_savana <- area_km2_savana*100/sites_aggregated_area_km2_num
        
        ## Mangue
        count_area_sites_intersected_mapbiomas_df_mangue <- sum(sites_intersected_mapbiomas_df_mangue$coverage_fraction)
        area_km2_mangue <- count_area_sites_intersected_mapbiomas_df_mangue * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_mangue <- area_km2_mangue*100/sites_aggregated_area_km2_num
        
        ## Campo Alagado e Área Pantanosa
        count_area_sites_intersected_mapbiomas_df_alagado_pantanosa <- sum(sites_intersected_mapbiomas_df_alagado_pantanosa$coverage_fraction)
        area_km2_alagado_pantanosa <- count_area_sites_intersected_mapbiomas_df_alagado_pantanosa * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_alagado_pantanosa <- area_km2_alagado_pantanosa*100/sites_aggregated_area_km2_num
        
        ## Formação Campestre
        count_area_sites_intersected_mapbiomas_df_campos <- sum(sites_intersected_mapbiomas_df_campos$coverage_fraction)
        area_km2_campos <- count_area_sites_intersected_mapbiomas_df_campos * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_campos <- area_km2_campos*100/sites_aggregated_area_km2_num
        
        ## Outras Formações não Florestais
        count_area_sites_intersected_mapbiomas_df_outras_nao_florestais <- sum(sites_intersected_mapbiomas_df_outras_nao_florestais$coverage_fraction)
        area_km2_outras_nao_florestais <- count_area_sites_intersected_mapbiomas_df_outras_nao_florestais * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_outras_nao_florestais <- area_km2_outras_nao_florestais*100/sites_aggregated_area_km2_num
        
        ## Lavoura Temporária
        count_area_sites_intersected_mapbiomas_df_lavouras_temporarias <- sum(sites_intersected_mapbiomas_df_lavouras_temporarias$coverage_fraction)
        area_km2_lavouras_temporarias <- count_area_sites_intersected_mapbiomas_df_lavouras_temporarias * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_lavouras_temporarias <- area_km2_lavouras_temporarias*100/sites_aggregated_area_km2_num
        
        ## Praia, Duna e Areal
        count_area_sites_intersected_mapbiomas_df_praia_duna_areal <- sum(sites_intersected_mapbiomas_df_praia_duna_areal$coverage_fraction)
        area_km2_praia_duna_areal <- count_area_sites_intersected_mapbiomas_df_praia_duna_areal * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_praia_duna_areal <- area_km2_praia_duna_areal*100/sites_aggregated_area_km2_num
        
        ## Outras Áreas não Vegetadas
        count_area_sites_intersected_mapbiomas_df_outras_nao_vegetadas <- sum(sites_intersected_mapbiomas_df_outras_nao_vegetadas$coverage_fraction)
        area_km2_outras_nao_vegetadas <- count_area_sites_intersected_mapbiomas_df_outras_nao_vegetadas * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_outras_nao_vegetadas <- area_km2_outras_nao_vegetadas*100/sites_aggregated_area_km2_num
        
        ## Não Observado
        count_area_sites_intersected_mapbiomas_df_nao_observado <- sum(sites_intersected_mapbiomas_df_nao_observado$coverage_fraction)
        area_km2_nao_observado <- count_area_sites_intersected_mapbiomas_df_nao_observado * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_nao_observado <- area_km2_nao_observado*100/sites_aggregated_area_km2_num
        
        ## Afloramento Rochoso
        count_area_sites_intersected_mapbiomas_df_afloramento_rochoso <- sum(sites_intersected_mapbiomas_df_afloramento_rochoso$coverage_fraction)
        area_km2_afloramento_rochoso <- count_area_sites_intersected_mapbiomas_df_afloramento_rochoso * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_afloramento_rochoso <- area_km2_afloramento_rochoso*100/sites_aggregated_area_km2_num
        
        ## Aquicultura
        count_area_sites_intersected_mapbiomas_df_aquicultura <- sum(sites_intersected_mapbiomas_df_aquicultura$coverage_fraction)
        area_km2_aquicultura <- count_area_sites_intersected_mapbiomas_df_aquicultura * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_aquicultura <- area_km2_aquicultura*100/sites_aggregated_area_km2_num
        
        ## Apicum
        count_area_sites_intersected_mapbiomas_df_apicum <- sum(sites_intersected_mapbiomas_df_apicum$coverage_fraction)
        area_km2_apicum <- count_area_sites_intersected_mapbiomas_df_apicum * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_apicum <- area_km2_apicum*100/sites_aggregated_area_km2_num
        
        ## Rio, Lago e Oceano
        count_area_sites_intersected_mapbiomas_df_rio_lago_oceano <- sum(sites_intersected_mapbiomas_df_rio_lago_oceano$coverage_fraction)
        area_km2_rio_lago_oceano <- count_area_sites_intersected_mapbiomas_df_rio_lago_oceano * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_rio_lago_oceano <- area_km2_rio_lago_oceano*100/sites_aggregated_area_km2_num
        
        ## Arroz
        count_area_sites_intersected_mapbiomas_df_arroz <- sum(sites_intersected_mapbiomas_df_arroz$coverage_fraction)
        area_km2_arroz <- count_area_sites_intersected_mapbiomas_df_arroz * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_arroz <- area_km2_arroz*100/sites_aggregated_area_km2_num
        
        ## Café
        count_area_sites_intersected_mapbiomas_df_cafe <- sum(sites_intersected_mapbiomas_df_cafe$coverage_fraction)
        area_km2_cafe <- count_area_sites_intersected_mapbiomas_df_cafe * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_cafe <- area_km2_cafe*100/sites_aggregated_area_km2_num
        
        ## Citrus
        count_area_sites_intersected_mapbiomas_df_citrus <- sum(sites_intersected_mapbiomas_df_citrus$coverage_fraction)
        area_km2_citrus <- count_area_sites_intersected_mapbiomas_df_citrus * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_citrus <- area_km2_citrus*100/sites_aggregated_area_km2_num
        
        ## Outras Lavouras Perenes
        count_area_sites_intersected_mapbiomas_df_outras_lavouras_perenes <- sum(sites_intersected_mapbiomas_df_outras_lavouras_perenes$coverage_fraction)
        area_km2_outras_lavouras_perenes <- count_area_sites_intersected_mapbiomas_df_outras_lavouras_perenes * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_outras_lavouras_perenes <- area_km2_outras_lavouras_perenes*100/sites_aggregated_area_km2_num
        
        ## Restinga Arborizada
        count_area_sites_intersected_mapbiomas_df_restinga_arborizada <- sum(sites_intersected_mapbiomas_df_restinga_arborizada$coverage_fraction)
        area_km2_restinga_arborizada <- count_area_sites_intersected_mapbiomas_df_restinga_arborizada * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_restinga_arborizada <- area_km2_restinga_arborizada*100/sites_aggregated_area_km2_num
        
        ## NA
        count_area_sites_intersected_mapbiomas_df_NA <- sum(sites_intersected_mapbiomas_df_NA$coverage_fraction)
        area_km2_NA <- count_area_sites_intersected_mapbiomas_df_NA * sites_aggregated_area_km2_num/count_sites_intersected_mapbiomas
        porc_area_km2_NA <- area_km2_NA*100/sites_aggregated_area_km2_num
        
        
        # Output Mapbiomas final ####
        final_output_mapbiomas_urbano <-
          data.frame(Species = ESPECIE,
                     Classe = "Infraestrutura Urbana",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_urbana), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_urbana), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_urbana") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_urbana, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_urbana") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_urbana), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_urbano)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_urbano)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_mineracao <-
          data.frame(Species = ESPECIE,
                     Classe = "Mineração",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_mineracao), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_mineracao), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_mineracao") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_mineracao, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_mineracao") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_mineracao), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_mineracao)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_mineracao)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_silvicultura <-
          data.frame(Species = ESPECIE,
                     Classe = "Silvicultura",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_silvicultura), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_silvicultura), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_silvicultura") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_silvicultura, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_silvicultura") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_silvicultura), 2)},
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_silvicultura)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_silvicultura)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_outras_lavouras_temporarias <-
          data.frame(Species = ESPECIE,
                     Classe = "Outras lavouras temporárias",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_outras_lavouras_temporarias), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_outras_lavouras_temporarias), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_outras_lavouras_temporarias") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_outras_lavouras_temporarias, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_outras_lavouras_temporarias") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_outras_lavouras_temporarias), 2)},
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_outras_lavouras_temporarias)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_outras_lavouras_temporarias)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_soja <-
          data.frame(Species = ESPECIE,
                     Classe = "Soja",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_soja), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_soja), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_soja") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_soja, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_soja") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_soja), 2)
                     },
                     Fonte="MapBiomas"
          )
        colnames(final_output_mapbiomas_soja)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_soja)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_cana <-
          data.frame(Species = ESPECIE,
                     Classe = "Cana-de-açúcar",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_cana), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_cana), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_cana") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_cana, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_cana") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_cana), 2)
                     },
                     Fonte="MapBiomas"
          )
        colnames(final_output_mapbiomas_cana)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_cana)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_lavouras_perenes <-
          data.frame(Species = ESPECIE,
                     Classe = "Lavouras perenes",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_lavouras_perenes), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_lavouras_perenes), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_lavouras_perenes") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_lavouras_perenes, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_lavouras_perenes") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_lavouras_perenes), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_lavouras_perenes)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_lavouras_perenes)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_pastagem <-
          data.frame(Species = ESPECIE,
                     Classe = "Pastagem",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_pastagem), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_pastagem), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_pastagem") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_pastagem, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_pastagem") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_pastagem), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_pastagem)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_pastagem)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_mosaic_past_agric <-
          data.frame(Species = ESPECIE,
                     Classe = "Mosaico Agricultura e Pastagem",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_mosaic_past_agric), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_mosaic_past_agric), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_mosaic_past_agric") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_mosaic_past_agric, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("area_EOO_km2_mosaic_past_agric") == F){
                       NA
                     } else{
                       round(as.numeric(area_EOO_km2_mosaic_past_agric), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_mosaic_past_agric)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_mosaic_past_agric)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_floresta <-
          data.frame(Species = ESPECIE,
                     Classe = "Floresta",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_floresta), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_floresta), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_floresta") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_floresta, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_floresta") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_floresta), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_floresta)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_floresta)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_savana <-
          data.frame(Species = ESPECIE,
                     Classe = "Savana",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_savana), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_savana), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_savana") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_savana, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_savana") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_savana), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_savana)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_savana)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_mangue <-
          data.frame(Species = ESPECIE,
                     Classe = "Mangue",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_mangue), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_mangue), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_mangue") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_mangue, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_mangue") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_mangue), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_mangue)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_mangue)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_alagado_pantanosa <-
          data.frame(Species = ESPECIE,
                     Classe = "Campo Alagado e Área Pantanosa",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_alagado_pantanosa), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_alagado_pantanosa), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_alagado_pantanosa") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_alagado_pantanosa, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_alagado_pantanosa") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_alagado_pantanosa), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_alagado_pantanosa)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_alagado_pantanosa)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_campos <-
          data.frame(Species = ESPECIE,
                     Classe = "Formação Campestre",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_campos), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_campos), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_campos") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_campos, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_campos") == F){
                       NA
                     } else{
                       round(
                         as.numeric(porc_area_EOO_km2_campos), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_campos)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_campos)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_outras_nao_florestais <-
          data.frame(Species = ESPECIE,
                     Classe = "Outras Formações não Florestais",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_outras_nao_florestais), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_outras_nao_florestais), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_outras_nao_florestais") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_outras_nao_florestais, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_outras_nao_florestais") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_outras_nao_florestais), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_outras_nao_florestais)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_outras_nao_florestais)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_lavouras_temporarias <-
          data.frame(Species = ESPECIE,
                     Classe = "Lavoura Temporária",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_lavouras_temporarias), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_lavouras_temporarias), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_lavouras_temporarias") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_lavouras_temporarias, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_lavouras_temporarias") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_lavouras_temporarias), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_lavouras_temporarias)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_lavouras_temporarias)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_praia_duna_areal <-
          data.frame(Species = ESPECIE,
                     Classe = "Praia, Duna e Areal",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_praia_duna_areal), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_praia_duna_areal), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_praia_duna_areal") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_praia_duna_areal, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_praia_duna_areal") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_praia_duna_areal), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_praia_duna_areal)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_praia_duna_areal)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_outras_nao_vegetadas <-
          data.frame(Species = ESPECIE,
                     Classe = "Outras Áreas não Vegetadas",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_outras_nao_vegetadas), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_outras_nao_vegetadas), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_outras_nao_vegetadas") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_outras_nao_vegetadas, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_outras_nao_vegetadas") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_outras_nao_vegetadas), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_outras_nao_vegetadas)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_outras_nao_vegetadas)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_nao_observado <-
          data.frame(Species = ESPECIE,
                     Classe = "Não Observado",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_nao_observado), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_nao_observado), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_nao_observado") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_nao_observado, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_nao_observado") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_nao_observado), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_nao_observado)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_nao_observado)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_afloramento_rochoso <-
          data.frame(Species = ESPECIE,
                     Classe = "Afloramento Rochoso",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_afloramento_rochoso), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_afloramento_rochoso), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_afloramento_rochoso") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_afloramento_rochoso, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_afloramento_rochoso") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_afloramento_rochoso), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_afloramento_rochoso)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_afloramento_rochoso)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_aquicultura <-
          data.frame(Species = ESPECIE,
                     Classe = "Aquicultura",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_aquicultura), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_aquicultura), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_aquicultura") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_aquicultura, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_aquicultura") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_aquicultura), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_aquicultura)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_aquicultura)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_apicum <-
          data.frame(Species = ESPECIE,
                     Classe = "Apicum",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_apicum), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_apicum), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_apicum") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_apicum, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_apicum") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_apicum), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_apicum)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_apicum)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_rio_lago_oceano <-
          data.frame(Species = ESPECIE,
                     Classe = "Rio, Lago e Oceano",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_rio_lago_oceano), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_rio_lago_oceano), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_rio_lago_oceano") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_rio_lago_oceano, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_rio_lago_oceano") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_rio_lago_oceano), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_rio_lago_oceano)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_rio_lago_oceano)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_arroz <-
          data.frame(Species = ESPECIE,
                     Classe = "Arroz",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_arroz), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_arroz), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_arroz") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_arroz, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_arroz") == F){
                       NA
                     } else{round(as.numeric(porc_area_EOO_km2_arroz), 2)
                     },
                     Fonte = "MapBiomas")
        colnames(final_output_mapbiomas_arroz)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_arroz)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_cafe <-
          data.frame(Species = ESPECIE,
                     Classe = "Café",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_cafe), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_cafe), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_cafe") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_cafe, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_cafe") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_cafe), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_cafe)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_cafe)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_citrus <-
          data.frame(Species = ESPECIE,
                     Classe = "Citrus",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_citrus), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_citrus), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_citrus") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_citrus, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_citrus") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_citrus), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_citrus)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_citrus)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_outras_lavouras_perenes <-
          data.frame(Species = ESPECIE,
                     Classe = "Outras Lavouras Perenes",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_outras_lavouras_perenes), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_outras_lavouras_perenes), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_outras_lavouras_perenes") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_outras_lavouras_perenes, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_outras_lavouras_perenes") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_outras_lavouras_perenes), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_outras_lavouras_perenes)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_outras_lavouras_perenes)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_restinga_arborizada <-
          data.frame(Species = ESPECIE,
                     Classe = "Restinga Arborizada",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_restinga_arborizada), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_restinga_arborizada), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_restinga_arborizada") == F){
                       "Análise dispensada"
                     } else{
                       round(area_EOO_km2_restinga_arborizada, 2)
                     },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_restinga_arborizada") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_restinga_arborizada), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_restinga_arborizada)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_restinga_arborizada)[c(3,5,7,9)], "_", "2020")
        
        final_output_mapbiomas_NA <-
          data.frame(Species = ESPECIE,
                     Classe = "NA",
                     Area_AOO_sites_km2 = round(as.numeric(area_km2_NA), 2),
                     Area_AOO_km2 = round(AOO_area_c_centr_mun, 2),
                     Porcentagem_AOO = round(as.numeric(porc_area_km2_NA), 2),
                     AOO_util_km2 = round(sites_aggregated_area_km2_num, 2),
                     Area_EOO_sites_km2 = if(exists("area_EOO_km2_NA") == F){
                       "Análise dispensada" } else{
                         round(area_EOO_km2_NA, 2)
                       },
                     Area_EOO_km2 = round(area_EOO_km2, 2),
                     Porcentagem_EOO = if(exists("porc_area_EOO_km2_NA") == F){
                       NA
                     } else{
                       round(as.numeric(porc_area_EOO_km2_NA), 2)
                     },
                     Fonte = "MapBiomas"
          )
        colnames(final_output_mapbiomas_NA)[c(3,5,7,9)] <- paste0(colnames(final_output_mapbiomas_NA)[c(3,5,7,9)], "_", "2020")
        
        
        # Output final ####
        output <- bind_rows(final_output_mapbiomas_soja, final_output_mapbiomas_cana, final_output_mapbiomas_lavouras_perenes, final_output_mapbiomas_outras_lavouras_temporarias, final_output_mapbiomas_pastagem, final_output_mapbiomas_mosaic_past_agric, final_output_mapbiomas_urbano, final_output_mapbiomas_mineracao, final_output_mapbiomas_silvicultura, final_output_mapbiomas_floresta, final_output_mapbiomas_savana, final_output_mapbiomas_mangue, final_output_mapbiomas_alagado_pantanosa, final_output_mapbiomas_campos, final_output_mapbiomas_outras_nao_florestais, final_output_mapbiomas_lavouras_temporarias, final_output_mapbiomas_praia_duna_areal, final_output_mapbiomas_outras_nao_vegetadas, final_output_mapbiomas_nao_observado, final_output_mapbiomas_afloramento_rochoso, final_output_mapbiomas_aquicultura, final_output_mapbiomas_apicum, final_output_mapbiomas_rio_lago_oceano, final_output_mapbiomas_arroz, final_output_mapbiomas_cafe, final_output_mapbiomas_citrus, final_output_mapbiomas_outras_lavouras_perenes, final_output_mapbiomas_restinga_arborizada, final_output_mapbiomas_NA)
        Feicoes <- output %>% dplyr::select(Classe)
        output_sites_AOO_km2_total <- output %>% dplyr::summarise(sum(get(paste0("Area_AOO_sites_km2_", "2020"))))
        if(output[1,7]=="Análise dispensada"|is.na(output[1,7])==T){
          output_sites_EOO_km2_total <-
            data.frame(output_sites_EOO_km2_total="Análise dispensada")
        } else{
          output_sites_EOO_km2_total <- output %>% dplyr::summarise(sum(get(paste0("Area_EOO_sites_km2_", "2020"))))
        }
        
        # Output Mapbiomas final ####
        final_output_mapbiomas_fogo <- data.frame(Species = ESPECIE,
                                                  Classe = Feicoes,
                                                  Area_AOO_sites_km2_2020 = round(as.numeric(output$Area_AOO_sites_km2_2020), 2),
                                                  Area_AOO_km2 = AOO_area_c_centr_mun,
                                                  Porcentagem_AOO_2020 = round(as.numeric(output$Porcentagem_AOO_2020), 2),
                                                  AOO_util_km2 = sites_aggregated_area_km2_num,
                                                  Area_EOO_sites_km2_2020 = if(output$Area_EOO_sites_km2_2020[1] == "Análise dispensada"){
                                                    "Análise dispensada"
                                                  } else{
                                                    output$Area_EOO_sites_km2_2020
                                                  },
                                                  Area_EOO_km2 = output$Area_EOO_km2,
                                                  Porcentagem_EOO_2020 = if(is.na(output$Porcentagem_EOO_2020[1]) == T){
                                                    NA
                                                  } else{
                                                    round(as.numeric(output$Porcentagem_EOO_2020), 2)
                                                  },
                                                  Fonte = "MapBiomas"
        )
        
      }
      
      # Output final ####
      output <- final_output_mapbiomas_fogo
      output_sites_AOO_km2_total <- output %>%
        summarise(sum(Area_AOO_sites_km2_2020))
      
      if(output$Area_EOO_sites_km2_2020[1] == "Análise dispensada" |
         is.na(output$Area_EOO_sites_km2_2020[1]) == T){
        output_sites_EOO_km2_total <- data.frame(output_sites_EOO_km2_total = "Análise dispensada")
      } else{
        output_sites_EOO_km2_total <- output %>%
          summarise(sum(Area_EOO_sites_km2_2020))
      }
      colnames(output_sites_AOO_km2_total) <- "Area_AOO_sites_km2"
      colnames(output_sites_EOO_km2_total) <- "Area_EOO_sites_km2"
      
      output_porcentagem_AOO_total <- output %>% summarise(sum(Porcentagem_AOO_2020))
      output_porcentagem_EOO_total <- output %>% summarise(sum(Porcentagem_EOO_2020))
      colnames(output_porcentagem_AOO_total)<-"Porcentagem_AOO"
      colnames(output_porcentagem_EOO_total)<-"Porcentagem_EOO"
      
      if(is.na(output$AOO_util_km2[1]) == T){
        AOO_area_s_centr_mun <- NA
      }
      
      if(is.na(output$Area_EOO_sites_km2[1]) == T){
        output_sites_EOO_km2_total <- data.frame(sites_EOO_km2 = NA)
      }
      
      output <- rbind(output,
                      data.frame(Species = output$Species[1],
                                 Classe = "Total",
                                 Area_AOO_sites_km2_2020 = output_sites_AOO_km2_total[1,],
                                 Area_AOO_km2 = output$Area_AOO_km2[1],
                                 Porcentagem_AOO_2020 = output_porcentagem_AOO_total[1,],
                                 AOO_util_km2 = AOO_area_s_centr_mun,
                                 Area_EOO_sites_km2_2020 = output_sites_EOO_km2_total[1,],
                                 Area_EOO_km2 = output$Area_EOO_km2[1],
                                 Porcentagem_EOO_2020 = output_porcentagem_EOO_total[1,],
                                 Fonte = output$Fonte[1]
                      )
      )
      
      # Para checar EOO total com EOO slices total
      # if(exists("area_EOO_km2_slices")){output <- data.frame(output, area_EOO_km2_slices)} else {output <- data.frame(output, area_EOO_km2_slices="Análise dispensada")}
      
      
      message(paste0(ESPECIE, ": Ano 2020 concluído"))
      
      
      write.csv(
        
        output,
        paste0(
          
          sub("Packages/CNCFloraR", "", getwd()),
          "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire results/",
          ESPECIE,
          ".csv"
          
        ),
        row.names = F
        
      )
      
      # Finish background log ####
      
      backgroundJobs_log$end <-
        format(Sys.Date(), "%d/%m/%Y")
      
      write.csv2(
        
        backgroundJobs_log,
        paste0(
          
          sub("Packages/CNCFloraR", "", getwd()),
          "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
          ESPECIE,
          ".csv"
          
        ),
        row.names = F
        
      )
      
    }
    
  },
  
  error = function(e){
    
    backgroundJobs_log$end <-
      "error"
    
    write.csv2(
      
      backgroundJobs_log,
      paste0(
        
        sub("Packages/CNCFloraR", "", getwd()),
        "/CNCFlora_data/outputs/overlayAnalysis MapBiomasFire logs/",
        ESPECIE,
        ".csv"
        
      ),
      row.names = F
      
    )
    
  }
  
)